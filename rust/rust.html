<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rust | Trdthg&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="logo.png">
    <meta name="description" content="我的个人网站">
    
    <link rel="preload" href="/assets/css/0.styles.c267aeb3.css" as="style"><link rel="preload" href="/assets/js/app.b12ebe4b.js" as="script"><link rel="preload" href="/assets/js/2.a44404e3.js" as="script"><link rel="preload" href="/assets/js/30.5e8b0065.js" as="script"><link rel="prefetch" href="/assets/js/10.a7d0caf6.js"><link rel="prefetch" href="/assets/js/11.2823f489.js"><link rel="prefetch" href="/assets/js/12.d5a69a97.js"><link rel="prefetch" href="/assets/js/13.3e72cb60.js"><link rel="prefetch" href="/assets/js/14.5a153fb4.js"><link rel="prefetch" href="/assets/js/15.12f851fa.js"><link rel="prefetch" href="/assets/js/16.de36f96c.js"><link rel="prefetch" href="/assets/js/17.11cabda5.js"><link rel="prefetch" href="/assets/js/18.82ba28fd.js"><link rel="prefetch" href="/assets/js/19.f2596cf4.js"><link rel="prefetch" href="/assets/js/20.3e7db87d.js"><link rel="prefetch" href="/assets/js/21.e74166e8.js"><link rel="prefetch" href="/assets/js/22.306bc3bb.js"><link rel="prefetch" href="/assets/js/23.13c441c6.js"><link rel="prefetch" href="/assets/js/24.8e40a7b4.js"><link rel="prefetch" href="/assets/js/25.afbe9a05.js"><link rel="prefetch" href="/assets/js/26.eec12d81.js"><link rel="prefetch" href="/assets/js/27.e4544ac2.js"><link rel="prefetch" href="/assets/js/28.4022ea5f.js"><link rel="prefetch" href="/assets/js/29.ecb6b6b4.js"><link rel="prefetch" href="/assets/js/3.ecc7c7a2.js"><link rel="prefetch" href="/assets/js/31.5b5bd938.js"><link rel="prefetch" href="/assets/js/4.f0607239.js"><link rel="prefetch" href="/assets/js/5.5d9b3b6c.js"><link rel="prefetch" href="/assets/js/6.4eb7a94a.js"><link rel="prefetch" href="/assets/js/7.ac27fb72.js"><link rel="prefetch" href="/assets/js/8.cf648b2c.js"><link rel="prefetch" href="/assets/js/9.52e3062a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.c267aeb3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Trdthg's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/java.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/js/vue.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/python/python.html" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/rust/wasm.html" class="nav-link">
  Rust
</a></div><div class="nav-item"><a href="/magic/haskell.html" class="nav-link">
  魔法
</a></div><div class="nav-item"><a href="/ioclub/oauth2.html" class="nav-link">
  IO Club
</a></div><div class="nav-item"><a href="/other/other.html" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="https://github.com/trdthg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/java.html" class="nav-link">
  Java
</a></div><div class="nav-item"><a href="/js/vue.html" class="nav-link">
  前端
</a></div><div class="nav-item"><a href="/python/python.html" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/rust/wasm.html" class="nav-link">
  Rust
</a></div><div class="nav-item"><a href="/magic/haskell.html" class="nav-link">
  魔法
</a></div><div class="nav-item"><a href="/ioclub/oauth2.html" class="nav-link">
  IO Club
</a></div><div class="nav-item"><a href="/other/other.html" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="https://github.com/trdthg" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/rust/wasm.html" class="sidebar-link">WebAssembly初体验</a></li><li><a href="/rust/rust.html" aria-current="page" class="active sidebar-link">Rust</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rust/rust.html#_1-lifetime" class="sidebar-link">1. lifetime</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rust/rust.html#自动处理生命周期" class="sidebar-link">自动处理生命周期</a></li></ul></li><li class="sidebar-sub-header"><a href="/rust/rust.html#_2-rc-arc" class="sidebar-link">2. Rc &amp; Arc</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rust/rust.html#introduce" class="sidebar-link">Introduce</a></li><li class="sidebar-sub-header"><a href="/rust/rust.html#try-unwrap" class="sidebar-link">try_unwrap()</a></li></ul></li><li class="sidebar-sub-header"><a href="/rust/rust.html#_4-cell-refcell" class="sidebar-link">4. Cell &amp; RefCell</a></li><li class="sidebar-sub-header"><a href="/rust/rust.html#_5-ref-refmut" class="sidebar-link">5. Ref &amp; RefMut</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/rust/rust.html#ref-map" class="sidebar-link">Ref::map()</a></li></ul></li></ul></li><li><a href="/rust/lists.html" class="sidebar-link">Too-Many-Lists</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="rust"><a href="#rust" class="header-anchor">#</a> Rust</h1> <h2 id="_1-lifetime"><a href="#_1-lifetime" class="header-anchor">#</a> 1. lifetime</h2> <h3 id="自动处理生命周期"><a href="#自动处理生命周期" class="header-anchor">#</a> 自动处理生命周期</h3> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// Only one reference in input, so the output must be derived from that input</span>
<span class="token keyword">fn</span> <span class="token function-definition function">foo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token class-name">A</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token class-name">B</span><span class="token punctuation">;</span> <span class="token comment">// sugar for:</span>
<span class="token keyword">fn</span> <span class="token function-definition function">foo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token class-name">A</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token class-name">B</span><span class="token punctuation">;</span>

<span class="token comment">// Many inputs, assume they're all independent</span>
<span class="token keyword">fn</span> <span class="token function-definition function">foo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token class-name">A</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name">C</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// sugar for:</span>
<span class="token keyword">fn</span> <span class="token function-definition function">foo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'b</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'c</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token class-name">A</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'b</span> <span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'c</span> <span class="token class-name">C</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Methods, assume all output lifetimes are derived from `self`</span>
<span class="token keyword">fn</span> <span class="token function-definition function">foo</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token class-name">C</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token class-name">D</span><span class="token punctuation">;</span> <span class="token comment">// sugar for:</span>
<span class="token keyword">fn</span> <span class="token function-definition function">foo</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'a</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'b</span><span class="token punctuation">,</span> <span class="token lifetime-annotation symbol">'c</span><span class="token operator">&gt;</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token keyword">self</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'b</span> <span class="token class-name">B</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'c</span> <span class="token class-name">C</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token operator">&amp;</span><span class="token lifetime-annotation symbol">'a</span> <span class="token class-name">D</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_2-rc-arc"><a href="#_2-rc-arc" class="header-anchor">#</a> 2. Rc &amp; Arc</h2> <h3 id="introduce"><a href="#introduce" class="header-anchor">#</a> Introduce</h3> <blockquote><p>The key to our design is the RefCell type. The heart of RefCell is a pair of methods:</p></blockquote> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">borrow</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Ref</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token keyword">fn</span> <span class="token function-definition function">borrow_mut</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">RefMut</span><span class="token operator">&lt;</span><span class="token lifetime-annotation symbol">'_</span><span class="token punctuation">,</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>Introducing inherited mutability roots to shared types Shared smart pointer types, including Rc and Arc, provide containers that can be cloned and shared between multiple parties. Because the contained values may be multiply-aliased, they can only be borrowed as shared references, not mutable references. Without cells it would be impossible to mutate data inside of shared boxes at all!</p></blockquote> <blockquote><p>It's very common then to put a RefCell inside shared pointer types to reintroduce mutability:</p></blockquote> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>collections<span class="token punctuation">::</span></span><span class="token class-name">HashMap</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cell<span class="token punctuation">::</span></span><span class="token class-name">RefCell</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>rc<span class="token punctuation">::</span></span><span class="token class-name">Rc</span><span class="token punctuation">;</span>
<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> shared_map<span class="token punctuation">:</span> <span class="token class-name">Rc</span><span class="token operator">&lt;</span><span class="token class-name">RefCell</span><span class="token operator">&lt;</span>_<span class="token operator">&gt;&gt;</span> <span class="token operator">=</span> <span class="token class-name">Rc</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">RefCell</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token class-name">HashMap</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    shared_map<span class="token punctuation">.</span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&quot;africa&quot;</span><span class="token punctuation">,</span> <span class="token number">92388</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    shared_map<span class="token punctuation">.</span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&quot;kyoto&quot;</span><span class="token punctuation">,</span> <span class="token number">11837</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    shared_map<span class="token punctuation">.</span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&quot;piccadilly&quot;</span><span class="token punctuation">,</span> <span class="token number">11826</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    shared_map<span class="token punctuation">.</span><span class="token function">borrow_mut</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span><span class="token string">&quot;marbles&quot;</span><span class="token punctuation">,</span> <span class="token number">38</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Note that this example uses Rc and not Arc. RefCells are for single-threaded scenarios. Consider using Mutex if you need shared mutability in a multi-threaded situation</p></blockquote> <h3 id="try-unwrap"><a href="#try-unwrap" class="header-anchor">#</a> try_unwrap()</h3> <blockquote><p>Get T from Rc&lt;T&gt; try to use <code>try_unwrap()</code>, which moves out the contents of an Rc if its refcount is 1</p></blockquote> <div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>unwrap on Result requires that you can debug-print the error case. RefCell only implements Debug if T does. Node doesn't implement Debug. try: Rc::try_unwrap(old_head).ok().unwrap().into_inner().elem</p></div> <h2 id="_4-cell-refcell"><a href="#_4-cell-refcell" class="header-anchor">#</a> 4. Cell &amp; RefCell</h2> <blockquote><p>Shareable mutable containers.</p> <p>Values of the Cell and RefCell types may be mutated through shared references (i.e. the common &amp;T type), whereas most Rust types can only be mutated through unique (&amp;mut T) references. We say that Cell and RefCell provide 'interior mutability', in contrast with typical Rust types that exhibit 'inherited mutability'.</p> <p>Cell types come in two flavors: Cell and RefCell. Cell provides get and set methods that change the interior value with a single method call. Cell though is only compatible with types that implement Copy. For other types, one must use the RefCell type, acquiring a write lock before mutating.</p> <p>RefCell uses Rust's lifetimes to implement 'dynamic borrowing', a process whereby one can claim temporary, exclusive, mutable access to the inner value. Borrows for RefCells are tracked 'at runtime', unlike Rust's native reference types which are entirely tracked statically, at compile time. Because RefCell borrows are dynamic it is possible to attempt to borrow a value that is already mutably borrowed; when this happens it results in thread panic.</p></blockquote> <h2 id="_5-ref-refmut"><a href="#_5-ref-refmut" class="header-anchor">#</a> 5. Ref &amp; RefMut</h2> <h3 id="ref-map"><a href="#ref-map" class="header-anchor">#</a> Ref::map()</h3> <h4 id="example1"><a href="#example1" class="header-anchor">#</a> example1</h4> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">Ref</span><span class="token operator">&lt;</span> <span class="token class-name">T</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> f<span class="token punctuation">:</span> <span class="token class-name">F</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Ref</span><span class="token operator">&lt;</span><span class="token class-name">U</span><span class="token operator">&gt;</span>
<span class="token comment">// Get Ref&lt;T&gt; from Ref&lt;Node&lt;T&gt;&gt;</span>
<span class="token comment">// my example</span>
<span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function-definition function">peek_front</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token class-name">Option</span><span class="token operator">&lt;</span><span class="token class-name">Ref</span><span class="token operator">&lt;</span><span class="token class-name">T</span><span class="token operator">&gt;&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">self</span><span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">as_ref</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>node<span class="token closure-punctuation punctuation">|</span></span> <span class="token punctuation">{</span>
        <span class="token class-name">Ref</span><span class="token punctuation">::</span><span class="token function">map</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span><span class="token function">borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>node<span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">&amp;</span>node<span class="token punctuation">.</span>elem<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="example2"><a href="#example2" class="header-anchor">#</a> example2</h4> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token comment">// Makes a new Ref for a component of the borrowed data.</span>

<span class="token comment">// The RefCell is already immutably borrowed, so this cannot fail.</span>

<span class="token comment">// This is an associated function that needs to be used as Ref::map(...). A method would interfere with methods of the same name on the contents of a RefCell used through Deref.</span>

<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span>cell<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">RefCell</span><span class="token punctuation">,</span> <span class="token class-name">Ref</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token class-name">RefCell</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token char string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b1<span class="token punctuation">:</span> <span class="token class-name">Ref</span><span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token keyword">u32</span><span class="token punctuation">,</span> <span class="token keyword">char</span><span class="token punctuation">)</span><span class="token operator">&gt;</span> <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">borrow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> b2<span class="token punctuation">:</span> <span class="token class-name">Ref</span><span class="token operator">&lt;</span><span class="token keyword">u32</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token class-name">Ref</span><span class="token punctuation">::</span><span class="token function">map</span><span class="token punctuation">(</span>b1<span class="token punctuation">,</span> <span class="token closure-params"><span class="token closure-punctuation punctuation">|</span>t<span class="token closure-punctuation punctuation">|</span></span> <span class="token operator">&amp;</span>t<span class="token number">.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property">assert_eq!</span><span class="token punctuation">(</span><span class="token operator">*</span>b2<span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/22/2021, 1:15:44 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/rust/wasm.html" class="prev">
        WebAssembly初体验
      </a></span> <span class="next"><a href="/rust/lists.html">
        Too-Many-Lists
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.b12ebe4b.js" defer></script><script src="/assets/js/2.a44404e3.js" defer></script><script src="/assets/js/30.5e8b0065.js" defer></script>
  </body>
</html>
