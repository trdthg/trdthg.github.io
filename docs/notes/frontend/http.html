<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-notes/frontend/http">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">HTTP ç›¸å…³ | Trdthg&#x27;s blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://trdthg.github.io//docs/notes/frontend/http"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="HTTP ç›¸å…³ | Trdthg&#x27;s blog"><meta data-rh="true" name="description" content="å‹ç¼©"><meta data-rh="true" property="og:description" content="å‹ç¼©"><link data-rh="true" rel="icon" href="/img/logo_png.png"><link data-rh="true" rel="canonical" href="https://trdthg.github.io//docs/notes/frontend/http"><link data-rh="true" rel="alternate" href="https://trdthg.github.io//docs/notes/frontend/http" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://trdthg.github.io//docs/notes/frontend/http" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Trdthg&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Trdthg&#39;s blog Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4TM86KZ83J"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4TM86KZ83J",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.6b28552f.css">
<link rel="preload" href="/assets/js/runtime~main.143e3a9c.js" as="script">
<link rel="preload" href="/assets/js/main.980f0465.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="è·³åˆ°ä¸»è¦å†…å®¹"><a href="#" class="skipToContent_fXgn">è·³åˆ°ä¸»è¦å†…å®¹</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo_png.png" alt="Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_png.png" alt="Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Trdthg</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/trdthg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰" aria-label="åˆ‡æ¢æµ…è‰²/æš—é»‘æ¨¡å¼ï¼ˆå½“å‰ä¸ºæµ…è‰²æ¨¡å¼ï¼‰"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="å›åˆ°é¡¶éƒ¨" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/-æ‹“å±•">ğŸ”® æ‹“å±•</a><button aria-label="æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ èœå•ã€ŒğŸ”® æ‹“å±•ã€" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/async">åç¨‹ä¸å¼‚æ­¥</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/bash">Bash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/cicd">CI/CD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/fd">æ–‡ä»¶ç³»ç»Ÿ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/go">Go è¯­è¨€</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/hadoop">å¤§æ•°æ®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/haskell">Haskell è¯­è¨€</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/linuxIO">IO å¤šè·¯å¤ç”¨</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/memory_ordering">åŸå­æ“ä½œä¸å†…å­˜é¡ºåº</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/software_arch">è½¯ä»¶æ¶æ„</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/-rust-è¯­è¨€">ğŸ¦€ Rust è¯­è¨€</a><button aria-label="æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ èœå•ã€ŒğŸ¦€ Rust è¯­è¨€ã€" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/rust">Rust è¯­è¨€</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/lists">Too-Many-Lists</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/mini_tokio">å¼‚æ­¥è¿è¡Œæ—¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/net-piercer">å†…ç½‘ç©¿é€å·¥å…·</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/print_into_detail">Rust print! å®</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/rs_channel">Channel æºç å‰–æ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/rust_quiz">Rust Quiz</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/wasm">Wasm å®ç°ç”Ÿå‘½æ¸¸æˆ</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/-å­¦ä¹ ç¬”è®°">ğŸ“š å­¦ä¹ ç¬”è®°</a><button aria-label="æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ èœå•ã€ŒğŸ“š å­¦ä¹ ç¬”è®°ã€" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/docs/category/å‰ç«¯">å‰ç«¯</a><button aria-label="æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ èœå•ã€Œå‰ç«¯ã€" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/frontend/css">å¸¸ç”¨ css</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/frontend/flutter">flutter</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/notes/frontend/http">HTTP ç›¸å…³</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/frontend/js_advanced">JS è¿›é˜¶</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/frontend/list">æœªæ•´ç†</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/frontend/mini_bundle">å®ç°ä¸€ä¸ª mini-bundle</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/frontend/mini_vue">Vue Mastery</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/frontend/vdom">è™šæ‹Ÿ DOM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/notes/frontend/vue">Vue</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/docs/category/java-å­¦ä¹ ">Java å­¦ä¹ </a><button aria-label="æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ èœå•ã€ŒJava å­¦ä¹ ã€" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/-èµ„æ–™åº“">ğŸ“¦ èµ„æ–™åº“</a><button aria-label="æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ èœå•ã€ŒğŸ“¦ èµ„æ–™åº“ã€" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/-io-club">âš½ IO Club</a><button aria-label="æ‰“å¼€/æ”¶èµ·ä¾§è¾¹æ èœå•ã€Œâš½ IO Clubã€" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">æ–‡æ¡£é¡µ</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/log">æ—¥å¿—</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="é¡µé¢è·¯å¾„"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ä¸»é¡µé¢" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/-å­¦ä¹ ç¬”è®°"><span itemprop="name">ğŸ“š å­¦ä¹ ç¬”è®°</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/å‰ç«¯"><span itemprop="name">å‰ç«¯</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">HTTP ç›¸å…³</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">æœ¬é¡µæ€»è§ˆ</button></div><div class="theme-doc-markdown markdown"><h1>HTTP ç›¸å…³</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="å‹ç¼©">å‹ç¼©<a class="hash-link" href="#å‹ç¼©" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="åç«¯-gzip">åç«¯ gzip<a class="hash-link" href="#åç«¯-gzip" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ç½‘å€ trdthg.github.io æ£€æµ‹ç»“æœ</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">æ˜¯å¦å‹ç¼©æ˜¯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å‹ç¼©ç±»å‹ gzip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">åŸå§‹æ–‡ä»¶å¤§å° 23146 å­—èŠ‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å‹ç¼©åæ–‡ä»¶å¤§å° 3454 å­—èŠ‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">å‹ç¼©ç‡ï¼ˆä¼°è®¡å€¼ï¼‰85.08%</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="é…ç½®å‹ç¼©">é…ç½®å‹ç¼©<a class="hash-link" href="#é…ç½®å‹ç¼©" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><ol start="2"><li>åœ¨ nginx é…ç½®å‹ç¼©æ•ˆæœ
<a href="http://nginx.org/en/docs/http/ngx_http_gzip_module.html" target="_blank" rel="noopener noreferrer">å®˜æ–¹ doc</a><a href="https://www.cnblogs.com/Renyi-Fan/p/11047490.html" target="_blank" rel="noopener noreferrer">åšå®¢</a></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gzip on;  #æ˜¯å¦å¼€å¯ gzip æ¨¡å— on è¡¨ç¤ºå¼€å¯ off è¡¨ç¤ºå…³é—­</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_buffers 4 16k;  #è®¾ç½®å‹ç¼©æ‰€éœ€è¦çš„ç¼“å†²åŒºå¤§å°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 6;  #å‹ç¼©çº§åˆ« 1-9ï¼Œæ•°å­—è¶Šå¤§å‹ç¼©çš„è¶Šå¥½ï¼Œä¹Ÿè¶Šå ç”¨ CPU æ—¶é—´</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_min_length 100k;  #è®¾ç½®å…è®¸å‹ç¼©çš„æœ€å°å­—èŠ‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_http_version 1.1;  #è®¾ç½®å‹ç¼© http åè®®çš„ç‰ˆæœ¬ï¼Œé»˜è®¤æ˜¯ 1.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_types text/plain text/css application/json application/x-javascript text/xml application/xml application/xml+rss text/javascript;  #è®¾ç½®å‹ç¼©çš„æ–‡ä»¶ç±»å‹</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_vary on;  #æ˜¯å¦åœ¨ http header ä¸­æ·»åŠ `Vary: Accept-Encoding`ï¼Œè¾…åŠ©é€‰æ‹©ä¸åŒå‹ç¼©ç®—æ³•äº§ç”Ÿçš„å‰¯æœ¬</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ³¨æ„ä¸€äº›ä¸å¸¸ç”¨çš„èµ„æºï¼Œæ¯”å¦‚å­—ä½“ï¼Œæœ‰éœ€è¦ä¹Ÿåº”è¯¥åŠ å…¥ gzip_type</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">å­—ä½“ç±»å‹æ‰©å±•å Content-type</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.eot    application/vnd.ms-fontobject</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.ttf    font/ttf</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.otf    font/opentype</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.woff   font/x-woff</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">.svg    image/svg+xml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>æ€ä¹ˆé€‰æ‹©åˆé€‚çš„å‹ç¼©æ¯”</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 0: 0ï¼Œ94840, 63 [ms], 29%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 1: 2.43ï¼Œ39005, 248 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 2: 2.51ï¼Œ37743, 273 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 3; 2.57ï¼Œ36849, 327 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 4; 2.73ï¼Œ34807, 370 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 5; 2.80ï¼Œ33898, 491 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 6; 2.82ï¼Œ33686, 604 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 7; 2.82ï¼Œ33626, 659 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 8; 2.82ï¼Œ33626, 698 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">gzip_comp_level 9; 2.82ï¼Œ33626, 698 [ms], 100%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- éšç€å‹ç¼©çº§åˆ«çš„å‡é«˜ï¼Œå‹ç¼©æ¯”æœ‰æ‰€æé«˜ï¼Œä½†åˆ°äº†çº§åˆ« 6 åï¼Œå¾ˆéš¾å†æé«˜ï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- éšç€å‹ç¼©çº§åˆ«çš„å‡é«˜ï¼Œå¤„ç†æ—¶é—´æ˜æ˜¾å˜æ…¢ï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">- gzip å¾ˆæ¶ˆè€— cpu çš„æ€§èƒ½ï¼Œé«˜å¹¶å‘æƒ…å†µä¸‹ cpu è¾¾åˆ° 100%</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>æ³¨æ„äº‹é¡¹</p><ul><li>ä¸æ˜¯å‹ç¼©çº§åˆ«è¶Šé«˜è¶Šå¥½ï¼Œå…¶å® gzip_comp_level 1 çš„å‹ç¼©èƒ½åŠ›å·²ç»å¤Ÿç”¨äº†ï¼Œåé¢çº§åˆ«è¶Šé«˜ï¼Œå‹ç¼©çš„æ¯”ä¾‹å…¶å®å¢é•¿ä¸å¤§ï¼Œåè€Œå¾ˆåƒå¤„ç†æ€§èƒ½ã€‚</li><li>å‹ç¼©ä¸€å®šè¦å’Œé™æ€èµ„æºç¼“å­˜ç›¸ç»“åˆï¼Œç¼“å­˜å‹ç¼©åçš„ç‰ˆæœ¬ï¼Œå¦åˆ™æ¯æ¬¡éƒ½å‹ç¼©é«˜è´Ÿè½½ä¸‹æœåŠ¡å™¨è‚¯å®šåƒä¸ä½ã€‚</li><li>å›¾ç‰‡/mp3 è¿™æ ·çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œä¸å¿…å‹ç¼©ï¼Œå› ä¸ºå‹ç¼©ç‡æ¯”è¾ƒå°ï¼Œæ¯”å¦‚ 100 åªèƒ½å‹ç¼©åˆ° 80 å­—èŠ‚ï¼Œè€Œä¸”å‹ç¼©ä¹Ÿæ˜¯è€—è´¹ CPU èµ„æºçš„ã€‚</li><li>æ¯”è¾ƒå°çš„æ–‡ä»¶ä¸å¿…å‹ç¼©ï¼Œæ„ä¹‰ä¸å­˜åœ¨ã€‚</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="é…ç½®å‹ç¼©ç¼“å­˜">é…ç½®å‹ç¼©ç¼“å­˜<a class="hash-link" href="#é…ç½®å‹ç¼©ç¼“å­˜" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>è¿™é‡Œçš„ç¼“å­˜æ§åˆ¶ä¸»è¦æ˜¯é’ˆå¯¹å›¾ç‰‡ï¼Œcss,js ç­‰å˜åŒ–å‘¨æœŸè¾ƒçŸ­çš„é™æ€æ–‡ä»¶; ç¬¬ä¸€æ¬¡è®¿é—® ä»¥å›¾ç‰‡ä¸ºä¾‹ï¼Œå½“æˆ‘ä»¬ç¬¬ä¸€æ¬¡è®¿é—®è¿™å¼ å›¾ç‰‡æ—¶ï¼ŒæœåŠ¡å™¨è¿”å›çš„æ˜¯
200ï¼ŒåŒæ—¶åœ¨å“åº”å¤´è¿”å›äº†ä¸¤ä¸ªé”®ï¼Œ</p><ul><li>Etag:å³è¯¥æ–‡ä»¶çš„&#x27;æŒ‡çº¹&#x27;(å”¯ä¸€æ ‡è¯†)</li><li>Last-Modified:&#x27;æ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´&#x27;; æ­¤æ—¶æµè§ˆå™¨ï¼Œä»¥åŠå…¶ä»–çš„ç¼“å­˜æœåŠ¡å™¨å°±ä¼šæŠŠè¿™å¼ å›¾ç‰‡ç»™ç¼“å­˜èµ·æ¥;</li></ul><p>ç¬¬äºŒæ¬¡è®¿é—® å†æ¬¡è¯·æ±‚è¿™å¼ å›¾ç‰‡æ—¶ï¼Œè¯·æ±‚å¤´å¢åŠ äº†ä¸¤ä¸ªé”®å€¼ï¼Œ</p><ul><li>If-Modified-Since:ä¸Šæ¬¡å‘ç”Ÿæ”¹å˜çš„æ—¶é—´;</li><li>If-None-Match:ä¸Šæ¬¡æ–‡ä»¶æœ¬èº«çš„ Etag å€¼ï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™ä¸¤ä¸ªé”®å€¼åˆ¤æ–­å…¶ Etag å’Œ
Last-Modifiedï¼Œå¦‚æœéƒ½æ²¡å‘ç”Ÿæ”¹å˜å°±ä¸è¿”å›è¿™å¼ å›¾ç‰‡ï¼Œåªè¿”å›ä¸€ä¸ª 304 çš„çŠ¶æ€ç ï¼ŒæœåŠ¡å™¨æ¥æ”¶åˆ°è¿™ä¸ª 304
çš„çŠ¶æ€ç å°±ä¼šè‡ªå·±å»ä»ç¼“å­˜é‡Œé¢æ‰¾è¿™ä¸ªè¢«ç¼“å­˜çš„å›¾ç‰‡;</li></ul><p>å¯ä»¥å‡å°‘æœåŠ¡å™¨çš„å¸¦å®½å‹åŠ›ä»¥åŠæå‡äº†ç½‘ç«™è®¿é—®é€Ÿåº¦;</p><div class="language-conf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-conf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">location ~* ^.+\.(ico|gif|jpg|jpeg|png)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  access_log   off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expires      30d;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">location ~* ^.+\.(css|js|txt|xml|swf|wav)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  access_log   off;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expires      24h;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">location ~* ^.+\.(html|htm)$ {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  expires      1h;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="terser-å‹ç¼©">terser å‹ç¼©<a class="hash-link" href="#terser-å‹ç¼©" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li><p>å»é™¤å¤šä½™å­—ç¬¦ï¼šç©ºæ ¼ï¼Œæ¢è¡ŒåŠæ³¨é‡Š</p><ul><li>å¤šè¡Œä»£ç å‹ç¼©åˆ°ä¸€è¡Œæ—¶è¦æ³¨æ„è¡Œå°¾åˆ†å·</li></ul></li><li><p>å‹ç¼©å˜é‡åï¼šå˜é‡åï¼Œå‡½æ•°ååŠå±æ€§å</p><ul><li>ç¼©çŸ­å˜é‡çš„å‘½åä¹Ÿéœ€è¦ AST æ”¯æŒï¼Œä¸è‡³äºåœ¨ä½œç”¨åŸŸä¸­é€ æˆå‘½åå†²çªã€‚</li></ul></li><li><p>è§£æç¨‹åºé€»è¾‘ï¼šåˆå¹¶å£°æ˜ä»¥åŠå¸ƒå°”å€¼ç®€åŒ–</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// å‹ç¼©å‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å‹ç¼©å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> a </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> b </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å‹ç¼©å‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">!</span><span class="token plain">b </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">c </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">d </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å‹ç¼©å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">!</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">b </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> c </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> d </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>è§£æç¨‹åºé€»è¾‘ï¼šç¼–è¯‘é¢„è®¡ç®—</li></ul><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// å‹ç¼©å‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ONE_YEAR</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">365</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">24</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">60</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å‹ç¼©å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">ONE_YAAR</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">31536000</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å‹ç¼©å‰</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;hello, world&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function" style="color:#d73a49">hello</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// å‹ç¼©å</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;hello, world&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="åº“">åº“<a class="hash-link" href="#åº“" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>uglifyã€terser ä¸ swc</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tree-shaking">tree shaking<a class="hash-link" href="#tree-shaking" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li><p>ä¾èµ–äº webpack é™æ€åˆ†æï¼Œç»“åˆ AST åˆ é™¤ä¸å¿…è¦çš„èŠ‚ç‚¹</p></li><li><p>å¯¹å¼•å…¥çš„ json æ–‡ä»¶åšé™æ€åˆ†æ</p><ul><li><p>éœ€è¦ä½¿ç”¨ wabpack æ’ä»¶<code>webpack-json-access-optimizer</code></p></li><li><p>æŠŠ json è½¬æ¢ä¸º arrayï¼Œå¹¶åˆ é™¤ä¸å¿…è¦çš„å†…å®¹</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// strings.json</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;Hello world!&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Hello world again!&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// index.js</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> strings </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;./strings.json&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">strings</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> strings</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></li><li><p>å¯¹ cssï¼Œä¸‹é¢ç”¨åˆ°äº† style-loaderï¼Œä¼šæŠŠ css åŠ åˆ° style æ ‡ç­¾é‡Œ</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">\.css$</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">use</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;style-loader&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;css-loader&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// You just have to add the sideEffects: true property to it.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">\.css$</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">use</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;style-loader&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;css-loader&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">sideEffects</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li><li><p>sideeffect èƒ½ç›´æ¥è·³è¿‡æ•´ä¸ªæ¨¡å—/æ–‡ä»¶
<img loading="lazy" src="https://blog.logrocket.com/tree-shaking-json-files-webpack/" alt="Webpack - Tree Shaking" class="img_ev3q">
<img loading="lazy" src="https://blog.logrocket.com/tree-shaking-json-files-webpack/" alt="JSON-CSS" class="img_ev3q"></p></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="http-ç¼“å­˜">http ç¼“å­˜<a class="hash-link" href="#http-ç¼“å­˜" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä»‹ç»">ä»‹ç»<a class="hash-link" href="#ä»‹ç»" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>æ›´å°‘çš„è¯·æ±‚ï¼Œæ›´å°‘çš„æµé‡ï¼Œæ›´å°‘çš„å³°å€¼å¸¦å®½ï¼Œä»è€ŒèŠ‚çœä¸€å¤§ç¬”æœåŠ¡å™¨æˆ–è€… CDN çš„è´¹ç”¨ã€‚</p><ul><li>å‡å°‘è¯·æ±‚æ¬¡æ•°</li><li>å‡å°‘å³°å€¼å¸¦å®½ æ§åˆ¶ HTTP ç¼“å­˜åªéœ€è¦ä½¿ç”¨ Cache-control æ§åˆ¶</li></ul><blockquote><p>Expiresï¼šæ˜¯ http1.0 çš„è§„èŒƒï¼Œå®ƒçš„å€¼æ˜¯ä¸€ä¸ªç»å¯¹æ—¶é—´çš„ GMT æ ¼å¼çš„æ—¶é—´å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ç½‘é¡µçš„ Expires å€¼æ˜¯ï¼šexpires:Mar,
06 Apr 2020 10:47:02 GMTã€‚é—®é¢˜ï¼šåˆ°æœŸæ—¶é—´æ˜¯ç”±æœåŠ¡ç«¯ç”Ÿæˆçš„ï¼Œå¦‚æœå®¢æˆ·ç«¯æ—¶é—´è·ŸæœåŠ¡å™¨æ—¶é—´ä¸ä¸€è‡´ï¼Œè¿™å°±ä¼šå¯¼è‡´ç¼“å­˜å‘½ä¸­çš„è¯¯å·®ã€‚
<strong>ä¸¤è€…åŒæ—¶å­˜åœ¨çš„è¯ï¼ŒCache-Control ä¼˜å…ˆçº§é«˜äº Expires</strong></p></blockquote><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cache-control">Cache-Control<a class="hash-link" href="#cache-control" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">1) max-ageï¼šç”¨æ¥è®¾ç½®èµ„æºï¼ˆrepresentationsï¼‰å¯ä»¥è¢«ç¼“å­˜å¤šé•¿æ—¶é—´ï¼Œå•ä½ä¸ºç§’ï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2) s-maxageï¼šå’Œ max-age æ˜¯ä¸€æ ·çš„ï¼Œä¸è¿‡å®ƒåªé’ˆå¯¹ä»£ç†æœåŠ¡å™¨ç¼“å­˜è€Œè¨€ï¼›**s-maxage çš„ä¼˜å…ˆçº§é«˜äº max-age**</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3) publicï¼šå¯ä»¥è¢«æ‰€æœ‰çš„ç”¨æˆ·ç¼“å­˜ï¼ŒåŒ…æ‹¬ç”¨æˆ·æµè§ˆå™¨å’Œ CDN ç­‰ä¸­é—´ä»£ç†æœåŠ¡å™¨ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4) privateï¼šåªèƒ½è¢«ç”¨æˆ·æµè§ˆå™¨ç¼“å­˜ï¼Œè€Œä¸èƒ½è¢«ä»£ç†æœåŠ¡å™¨ç¼“å­˜ï¼›</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5) no-cacheï¼šno-cache æ˜¯ä¼šè¢«ç¼“å­˜çš„ï¼Œä½†æ˜¯ä¾ç„¶å¼ºåˆ¶å®¢æˆ·ç«¯ç›´æ¥å‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œåªä¸è¿‡æ¯æ¬¡åœ¨å‘å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰æä¾›å“åº”æ•°æ®æ—¶ï¼Œç¼“å­˜éƒ½è¦å‘æœåŠ¡å™¨è¯„ä¼°ç¼“å­˜å“åº”çš„æœ‰æ•ˆæ€§ã€‚å½“æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚ï¼Œä¼šåˆ¤æ–­èµ„æºæ˜¯å¦å˜æ›´ï¼Œå˜æ›´åˆ™è¿”å›æ–°å†…å®¹ï¼Œå¦åˆ™è¿”å› 304ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">6) no-storeï¼šç¦æ­¢ä¸€åˆ‡ç¼“å­˜ï¼ˆå“åº”çœŸçš„ä¸è¢«ç¼“å­˜ï¼‰ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">7) max-staleï¼šèƒ½å®¹å¿çš„æœ€å¤§è¿‡æœŸæ—¶é—´ã€‚max-stale æŒ‡ä»¤æ ‡ç¤ºäº†å®¢æˆ·ç«¯æ„¿æ„æ¥æ”¶ä¸€ä¸ªå·²ç»è¿‡æœŸäº†çš„å“åº”ã€‚å¦‚æœæŒ‡å®šäº† max-stale çš„å€¼ï¼Œåˆ™æœ€å¤§å®¹å¿æ—¶é—´ä¸ºå¯¹åº”çš„ç§’æ•°ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œé‚£ä¹ˆè¯´æ˜æµè§ˆå™¨æ„¿æ„æ¥æ”¶ä»»ä½• age çš„å“åº”ï¼ˆage è¡¨ç¤ºå“åº”ç”±æºç«™ç”Ÿæˆæˆ–ç¡®è®¤çš„æ—¶é—´ä¸å½“å‰æ—¶é—´çš„å·®å€¼ï¼‰ã€‚</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8) min-freshï¼šèƒ½å¤Ÿå®¹å¿çš„æœ€å°æ–°é²œåº¦ã€‚min-fresh æ ‡ç¤ºäº†å®¢æˆ·ç«¯ä¸æ„¿æ„æ¥å—æ–°é²œåº¦ä¸å¤šäºå½“å‰çš„ age åŠ ä¸Š min-fresh è®¾å®šçš„æ—¶é—´ä¹‹å’Œçš„å“åº”ã€‚</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ä»€ä¹ˆæ˜¯æŒ‡çº¹">ä»€ä¹ˆæ˜¯æŒ‡çº¹<a class="hash-link" href="#ä»€ä¹ˆæ˜¯æŒ‡çº¹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p><img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202122340765.png" class="img_ev3q">
å¦‚å›¾æ‰€ç¤ºï¼ŒæŒ‡çº¹å°±æ˜¯æ–‡ä»¶çš„ hash å€¼</p><ul><li>main.js å¸¦æœ‰ hash å€¼ï¼Œå±äºå¸¦æŒ‡çº¹çš„æ°¸ä¹…èµ„æº (å¼ºç¼“å­˜)</li><li>index.js ä¸å¸¦ hash å€¼ï¼Œè™½ç„¶è®¾ç½®äº† no-chcheï¼Œä½†æ˜¯ä¾ç„¶æ˜¯åå•†ç¼“å­˜</li></ul><p>åŒºåˆ«ä¸‹é¢ä¸¤ç§ç¼“å­˜å°±æ˜¯ä¾é æŒ‡çº¹ (æ˜¯ä¸æ˜¯æ°¸ä¹…ç¼“å­˜)ï¼Œè€Œ cache-control å€¼æ˜¯å†³å®šå¯¹ç¼“å­˜çš„å¤„ç†ç­–ç•¥ (å­˜ä¸å­˜ï¼Œç”¨ä¸ç”¨)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ–‡ä»¶æŒ‡çº¹ç”Ÿæˆç­–ç•¥">æ–‡ä»¶æŒ‡çº¹ç”Ÿæˆç­–ç•¥<a class="hash-link" href="#æ–‡ä»¶æŒ‡çº¹ç”Ÿæˆç­–ç•¥" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ç”Ÿæˆç­–ç•¥">ç”Ÿæˆç­–ç•¥<a class="hash-link" href="#ç”Ÿæˆç­–ç•¥" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><ul><li>hashï¼šå½“æœ‰æ–‡ä»¶ä¿®æ”¹ï¼Œæ•´ä¸ªé¡¹ç›®æ„å»ºçš„ hash å€¼å°±ä¼šæ›´æ–°ã€‚ <code>filename: &#x27;[name]-[hash].bundle.css&#x27;</code></li><li>chunkhashï¼šå’Œ webpack æ‰“åŒ…çš„ chunk ç›¸å…³ï¼Œä¸åŒçš„ entry ä¼šç”Ÿæˆä¸åŒçš„ hashï¼Œä¸€èˆ¬ç”¨äº js çš„æ‰“åŒ…ã€‚
<code>filename: &#x27;[name]-[chunkhash].bundle.css&#x27;</code></li><li>contenthashï¼šæ ¹æ®æ–‡ä»¶å†…å®¹æ¥å®šä¹‰ hashï¼Œæ–‡ä»¶å†…å®¹ä¸å˜ï¼Œcontenthash ä¸å˜ã€‚ä¾‹å¦‚ css çš„æ‰“åŒ…ï¼Œç”±äº ä¿®æ”¹ js æˆ– html
æ–‡ä»¶ï¼Œä½†æ˜¯æ²¡æœ‰ä¿®æ”¹å¼•å…¥çš„ css æ ·å¼æ—¶ï¼Œæ–‡ä»¶ä¸éœ€è¦ç”Ÿæˆæ–°çš„å“ˆå¸Œå€¼ï¼Œæ‰€ä»¥å¯é€‚ç”¨äº css çš„æ‰“åŒ…ã€‚
<code>filename: &#x27;[name]-[contenthash:8].bundle.css&#x27;</code></li></ul><blockquote><p>å¯ä»¥åœ¨å“ˆå¸Œæœ«å°¾é…ç½®å“ˆå¸Œå€¼çš„é•¿åº¦
<a href="https://webpack.js.org/configuration/output/#template-strings" target="_blank" rel="noopener noreferrer">filename é…ç½®æ ¼å¼</a></p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="js-chunkhash">js-chunkhash<a class="hash-link" href="#js-chunkhash" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">JS</span><span class="token plain"> æ–‡ä»¶æŒ‡çº¹è®¾ç½®ï¼š</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">chunkhash</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">entry</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">index</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./src/index.js&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">search</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;./src/search.js&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">output</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">__dirname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;dist&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">filename</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[name][chunkhash:8].js&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="css-contenthash">css-contenthash<a class="hash-link" href="#css-contenthash" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>CSS æ–‡ä»¶æŒ‡çº¹ï¼šcontenthash --ï¼ˆmin-css-extract-plugin å¯ä»¥ç”Ÿäº§ css æ–‡ä»¶ï¼‰
1.ç›´æ¥ä½¿ç”¨&#x27;style-loader&#x27;æ–¹å¼é€šè¿‡ style æ ‡ç­¾å°† CSS æ’å…¥åˆ° head ä¸­å¹¶æ²¡æœ‰ç”Ÿæˆå•ç‹¬çš„ CSS æ–‡ä»¶ï¼Œå› æ­¤ä¹Ÿä¸å­˜åœ¨
ä½¿ç”¨æŒ‡çº¹æ—¶å€™å¯ä»¥æ›´æ–°æ–‡ä»¶ï¼Œæ‰€ä»¥è¿™é‡Œé€šè¿‡&#x27;min-css-extract-plugin&#x27;æ’ä»¶å°† CSS æå–æˆå•ç‹¬çš„ CSS æ–‡ä»¶ï¼Œå¹¶æ·»åŠ æ–‡ä»¶æŒ‡çº¹ã€‚2.å®‰è£…ä¾èµ–
mini-css-extract-plugin -- &#x27;npm i mini-css-extract-plugin -D&#x27;</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">MiniCssExtractPlugin</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;mini-css-extract-plugin&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">module</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">rules</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">\.css$</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">use</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token maybe-class-name">MiniCssExtractPlugin</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">loader</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token string" style="color:#e3116c">&quot;css-loader&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">plugins</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">MiniCssExtractPlugin</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">filename</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;[name][contenthash:8].css&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="img-hash">img-hash<a class="hash-link" href="#img-hash" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>å›¾ç‰‡æ–‡ä»¶æŒ‡çº¹è®¾ç½®ï¼šhash 1.å…¶ä¸­ï¼Œhash å¯¹åº”çš„æ˜¯æ–‡ä»¶å†…å®¹çš„å“ˆå¸Œå€¼ï¼Œé»˜è®¤ä¸º md5 ç”Ÿæˆï¼Œä¸åŒäºå‰é¢æ‰€è¯´çš„ hash å€¼ã€‚</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">module</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">module</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">rules</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">test</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">\.(png|svg|jpg|jpeg|gif)$</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">use</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">loader</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;file-loader&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">options</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;img/[name][hash:8].[ext]&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="æ³¨æ„äº‹é¡¹">æ³¨æ„äº‹é¡¹<a class="hash-link" href="#æ³¨æ„äº‹é¡¹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><blockquote><p>ä½¿ç”¨äº† md5 æŒ‡çº¹ä¹‹åå‘ç°æ¯æ¬¡æ‰“åŒ…è¿˜æ˜¯ä¼šå‘ç”Ÿå˜åŒ–ï¼Ÿç­”ï¼šè¿™æ˜¯ç”±äº webpack çš„å¤„ç†æœºåˆ¶å¯¼è‡´çš„ï¼Œwebpack
æ¯æ¬¡æ‰“åŒ…ä¼šæŠŠæ¯ä¸ªæ¨¡å—çš„é…ç½®ä¿¡æ¯ï¼Œå¦‚æ–‡ä»¶åã€æ–‡ä»¶é¡ºåºã€æ–‡ä»¶ md5 ç­‰ä¿¡æ¯ä½œä¸ºé…ç½®æ‰“å…¥ js
ä¸­ï¼Œä»¥ä¾¿äºå…¶è¿›è¡Œæ¨¡å—ç®¡ç†ï¼Œè€Œè¿™éƒ¨å†…å®¹ï¼Œæ¯æ¬¡æ‰“åŒ…éƒ½æœ‰å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼Œå¯¼è‡´æ•´ä¸ª js æ–‡ä»¶åæ¯æ¬¡éƒ½ä¼šå‘ç”Ÿå˜åŒ–ã€‚webpack æä¾›äº†ä¸€ä¸ª manifest
çš„æœºåˆ¶æ¥å‰¥å‡ºè¿™ä¸ªé…ç½®æ–‡ä»¶ã€‚æˆ‘ä»¬éœ€è¦ä½¿ç”¨ CommonsChunkPlugin æ¥å°†å…¶å‰¥ç¦»ï¼ŒåŒæ—¶ä½¿ç”¨
chunk-manifest-webpack-plugin è¯»å–å…¶ å†…å®¹å¯¼å‡ºå¦å¤–ä¸€ä¸ªæ–‡ä»¶ï¼Œé˜²æ­¢å…¶å†…å®¹å˜åŒ–å¯¼è‡´æ•´ä¸ª js æ–‡ä»¶æŒ‡çº¹å‘ç”Ÿå˜åŒ–</p></blockquote><h4 class="anchor anchorWithStickyNavbar_LWe7" id="bundle-splittingå°½é‡å‡å°‘èµ„æºå˜æ›´">Bundle Splittingï¼šå°½é‡å‡å°‘èµ„æºå˜æ›´<a class="hash-link" href="#bundle-splittingå°½é‡å‡å°‘èµ„æºå˜æ›´" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>æŠŠå¤§ js æ–‡ä»¶ï¼Œåˆ†æˆå°çš„æ–‡ä»¶ï¼Œå°½é‡å‡å°‘ç¼“å­˜å¤±æ•ˆçš„èŒƒå›´
<img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202130126302.png" class="img_ev3q">
æ­¤æ—¶æˆ‘ä»¬å¯ä»¥å¯¹èµ„æºè¿›è¡Œåˆ†å±‚æ¬¡ç¼“å­˜çš„æ‰“åŒ…æ–¹æ¡ˆï¼Œè¿™æ˜¯ä¸€ä¸ªå»ºè®®æ–¹æ¡ˆï¼š</p><ul><li>webpack-runtime: åº”ç”¨ä¸­çš„ webpack çš„ç‰ˆæœ¬æ¯”è¾ƒç¨³å®šï¼Œåˆ†ç¦»å‡ºæ¥ï¼Œä¿è¯é•¿ä¹…çš„æ°¸ä¹…ç¼“å­˜</li><li>react/react-dom: react çš„ç‰ˆæœ¬æ›´æ–°é¢‘æ¬¡ä¹Ÿè¾ƒä½</li><li>vendor: å¸¸ç”¨çš„ç¬¬ä¸‰æ–¹æ¨¡å—æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œå¦‚ lodashï¼Œ- classnames
åŸºæœ¬ä¸Šæ¯ä¸ªé¡µé¢éƒ½ä¼šå¼•ç”¨åˆ°ï¼Œä½†æ˜¯å®ƒä»¬çš„æ›´æ–°é¢‘ç‡ä¼šæ›´é«˜ä¸€äº›ã€‚å¦å¤–å¯¹ä½é¢‘æ¬¡ä½¿ç”¨çš„ç¬¬ä¸‰æ–¹æ¨¡å—ä¸è¦æ‰“è¿›æ¥</li><li>pageA: A è·¯ç”±é¡µé¢ï¼Œå½“ A é¡µé¢çš„ç»„ä»¶å‘ç”Ÿå˜æ›´åï¼Œå®ƒçš„ç¼“å­˜å°†ä¼šå¤±æ•ˆ</li><li>pageB: B è·¯ç”±é¡µé¢</li><li>echarts: ä¸å¸¸ç”¨ä¸”è¿‡å¤§çš„ç¬¬ä¸‰æ–¹æ¨¡å—å•ç‹¬æ‰“åŒ…</li><li>mathjax: ä¸å¸¸ç”¨ä¸”è¿‡å¤§çš„ç¬¬ä¸‰æ–¹æ¨¡å—å•ç‹¬æ‰“åŒ…</li><li>jspdf: ä¸å¸¸ç”¨ä¸”è¿‡å¤§çš„ç¬¬ä¸‰æ–¹æ¨¡å—å•ç‹¬æ‰“åŒ…</li></ul><p>éšç€ <strong>http2</strong>
çš„å‘å±•ï¼Œç‰¹åˆ«æ˜¯å¤šè·¯å¤ç”¨ï¼Œåˆå§‹é¡µé¢çš„é™æ€èµ„æºä¸å—èµ„æºæ•°é‡çš„å½±å“ã€‚å› æ­¤ä¸ºäº†æ›´å¥½çš„ç¼“å­˜æ•ˆæœä»¥åŠæŒ‰éœ€åŠ è½½ï¼Œä¹Ÿæœ‰å¾ˆå¤šæ–¹æ¡ˆå»ºè®®æŠŠ<strong>æ‰€æœ‰çš„ç¬¬ä¸‰æ–¹æ¨¡å—è¿›è¡Œå•æ¨¡å—æ‰“åŒ…</strong>ã€‚</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="æ°¸ä¹…ç¼“å­˜--å¼ºåˆ¶ç¼“å­˜-å¸¦æŒ‡çº¹">æ°¸ä¹…ç¼“å­˜ / å¼ºåˆ¶ç¼“å­˜ (å¸¦æŒ‡çº¹)<a class="hash-link" href="#æ°¸ä¹…ç¼“å­˜--å¼ºåˆ¶ç¼“å­˜-å¸¦æŒ‡çº¹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Cache-Control: public,max-age=31536000,immutable</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>max-age è¡¨ç¤ºç¼“å­˜æ—¶é—´ä¸º 1 å¹´ï¼Œç›´æ¥ä»ç¼“å­˜æ•°æ®åº“ (æµè§ˆå™¨çš„æœ¬åœ°ç¼“å­˜) æ‹¿åˆ°æ•°æ®ï¼Œä¸‹å›¾ä¸­çš„ (disk cache) å°±æ˜¯
<img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202122312621.png" class="img_ev3q">
è€Œä¸ºäº†è§£å†³æ›´æ–°çš„é—®é¢˜ï¼Œå°±éœ€è¦åœ¨æ–‡ä»¶å (æˆ–è€…è·¯å¾„) ä¸­æ·»åŠ  hashï¼Œç‰ˆæœ¬å·ç­‰åŠ¨æ€å­—ç¬¦ï¼Œä¹‹åæ›´æ”¹åŠ¨æ€å­—ç¬¦ï¼Œä»è€Œè¾¾åˆ°æ›´æ”¹å¼•ç”¨ URL çš„ç›®çš„ï¼Œè®©ä¹‹å‰çš„å¼ºåˆ¶ç¼“å­˜å¤±æ•ˆ
(å…¶å®å¹¶æœªç«‹å³å¤±æ•ˆï¼Œåªæ˜¯ä¸å†ä½¿ç”¨äº†è€Œå·²)ã€‚åœ¨çº¿æä¾›çš„ç±»åº“ (å¦‚ jquery-3.3.1.min.js, lodash.min.js ç­‰) å‡é‡‡ç”¨è¿™ä¸ªæ¨¡å¼ã€‚</p><p><strong>é»˜è®¤çš„å¼ºåˆ¶ç¼“å­˜æ—¶é—´</strong></p><p>é¦–å…ˆè¦æ˜ç¡®ä¸¤ä¸ªå“åº”å¤´ä»£è¡¨çš„å«ä¹‰ï¼š</p><ul><li>Date: æŒ‡æºæœåŠ¡å™¨å“åº”æŠ¥æ–‡ç”Ÿæˆçš„æ—¶é—´ï¼Œå·®ä¸å¤šä¸å‘è¯·æ±‚çš„æ—¶é—´ç­‰ä»·</li><li>Last-Modified: æŒ‡é™æ€èµ„æºä¸Šæ¬¡ä¿®æ”¹çš„æ—¶é—´ï¼Œå–å†³äº mtime</li></ul><p>LM factor ç®—æ³•è®¤ä¸ºå½“è¯·æ±‚æœåŠ¡å™¨æ—¶ï¼Œå¦‚æœæ²¡æœ‰è®¾ç½® Cache-Controlï¼Œå¦‚æœè·ç¦»ä¸Šæ¬¡çš„ Last-Modified
è¶Šè¿œï¼Œåˆ™ç”Ÿæˆçš„å¼ºåˆ¶ç¼“å­˜æ—¶é—´è¶Šé•¿ã€‚</p><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ç”¨å…¬å¼è¡¨ç¤ºå¦‚ä¸‹ï¼Œå…¶ä¸­ factor ä»‹äº 0 ä¸ 1 ä¹‹é—´ï¼š</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">MaxAge</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token known-class-name class-name">Date</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token maybe-class-name">LastModified</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> factor</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202130123289.png" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="åå•†ç¼“å­˜--å¯¹æ¯”ç¼“å­˜-ä¸å¸¦æŒ‡çº¹">åå•†ç¼“å­˜ / å¯¹æ¯”ç¼“å­˜ (ä¸å¸¦æŒ‡çº¹)<a class="hash-link" href="#åå•†ç¼“å­˜--å¯¹æ¯”ç¼“å­˜-ä¸å¸¦æŒ‡çº¹" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>ç¬¬ä¸€æ¬¡è¯·æ±‚ä¼šç¼“å­˜<code>æ•°æ®ï¼ŒEtagï¼ŒLast-Modified</code>ï¼Œä¹‹åè¯·æ±‚éƒ½è¦å‘å‡ºè¯·æ±‚æºå¸¦<code>If-Modified-Since, If-None-Match</code>åˆ¤æ–­ç¼“å­˜çš„æ—¶æ•ˆæ€§ï¼Œå¦‚æœæ˜¯
304ï¼Œå°±è¡¨ç¤ºç¼“å­˜å¯ç”¨ï¼Œæµè§ˆå™¨å°±ç›´æ¥ç”¨ç¼“å­˜æ•°æ®
<img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202122321204.png" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="etag-å’Œ-last-modified-çš„åŒºåˆ«">Etag å’Œ Last-Modified çš„åŒºåˆ«<a class="hash-link" href="#etag-å’Œ-last-modified-çš„åŒºåˆ«" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>Etag ä¼˜å…ˆçº§æ›´é«˜ï¼ŒæœåŠ¡å‰å…ˆæ¯”è¾ƒ Etagï¼ŒåŒæ—¶å­˜åœ¨æ—¶ä¼šä»¥ ETag ä¸ºå‡†ã€‚</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="last-modified--if-modified-since">Last-Modified / If-Modified-Since<a class="hash-link" href="#last-modified--if-modified-since" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><ol><li>ç²¾ç¡®åˆ°ç§’ï¼š<code>Last-Modify: Thu,31 Dec 2037 23:59:59 GMT</code></li><li>ä½¿ç”¨<code>stat ./xxx.txt</code>è·å–æ–‡ä»¶ (å¤¹) ä¿¡æ¯</li></ol><p>æœåŠ¡å™¨å“åº”è¯·æ±‚æ—¶ï¼Œä¼šå‘Šè¯‰æµè§ˆå™¨ä¸€ä¸ªå‘Šè¯‰æµè§ˆå™¨èµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ï¼šLast-Modifiedï¼Œæµè§ˆå™¨ä¹‹åå†è¯·æ±‚çš„æ—¶å€™ï¼Œä¼šå¸¦ä¸Šä¸€ä¸ªå¤´ï¼šIf-Modified-Sinceï¼Œè¿™ä¸ªå€¼å°±æ˜¯æœåŠ¡å™¨ä¸Šä¸€æ¬¡ç»™çš„
Last-Modified çš„æ—¶é—´ï¼ŒæœåŠ¡å™¨ä¼šæ¯”å¯¹èµ„æºå½“å‰æœ€åçš„ä¿®æ”¹æ—¶é—´ï¼Œå¦‚æœå¤§äº
If-Modified-Sinceï¼Œåˆ™è¯´æ˜èµ„æºä¿®æ”¹è¿‡äº†ï¼Œæµè§ˆå™¨ä¸èƒ½å†ä½¿ç”¨ç¼“å­˜ï¼Œå¦åˆ™æµè§ˆå™¨å¯ä»¥ç»§ç»­ä½¿ç”¨ç¼“å­˜ï¼Œå¹¶è¿”å› 304 çŠ¶æ€ç ã€‚</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="etag--if-none-match">Etag / If-None-Match<a class="hash-link" href="#etag--if-none-match" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><ol><li>Etag/If-None-Match æ˜¯â€œå®ä½“æ ‡ç­¾â€ï¼ˆEntity Tagï¼‰çš„ç¼©å†™</li><li>ä¼˜å…ˆçº§é«˜äº Last-Modified / If-Modified-Sinceï¼‰</li><li>ä¼˜åŠ¿</li></ol><ul><li>è§£å†³å†…å®¹å¹¶ä¸æ”¹å˜ï¼Œä»…ä»…æ”¹æ”¹å˜ä¿®æ”¹æ—¶é—´çš„é—®é¢˜</li><li>è§£å†³åªå°±ç²¾ç¡®åˆ°ç§’çš„é—®é¢˜ï¼šæŸäº›æ–‡ä»¶ä¿®æ”¹éå¸¸é¢‘ç¹ï¼Œæ¯”å¦‚åœ¨ç§’ä»¥ä¸‹çš„æ—¶é—´å†…è¿›è¡Œä¿®æ”¹ï¼Œ(æ¯”æ–¹è¯´ 1s å†…ä¿®æ”¹äº† N æ¬¡)ï¼ŒIf-Modified-Since
èƒ½æ£€æŸ¥åˆ°çš„ç²’åº¦æ˜¯ s çº§çš„ï¼Œè¿™ç§ä¿®æ”¹æ— æ³•åˆ¤æ–­ (æˆ–è€…è¯´ UNIX è®°å½• MTIME åªèƒ½ç²¾ç¡®åˆ°ç§’)ï¼›</li><li>æŸäº›æœåŠ¡å™¨ä¸èƒ½ç²¾ç¡®çš„å¾—åˆ°æ–‡ä»¶çš„æœ€åä¿®æ”¹æ—¶é—´ã€‚</li></ul><p>æœåŠ¡å™¨å“åº”è¯·æ±‚æ—¶ï¼Œé€šè¿‡ Etag å¤´éƒ¨å‘Šè¯‰æµè§ˆå™¨å½“å‰èµ„æºåœ¨æœåŠ¡å™¨çš„å”¯ä¸€æ ‡è¯†ï¼ˆç”Ÿæˆè§„åˆ™ç”±æœåŠ¡å™¨å†³å®šï¼‰ï¼Œæµè§ˆå™¨å†æ¬¡è¯·æ±‚æ—¶ï¼Œå°±ä¼šå¸¦ä¸Šä¸€ä¸ªå¤´
If-None-Matchï¼Œè¿™ä¸ªå€¼å°±æ˜¯æœåŠ¡å™¨ä¸Šä¸€æ¬¡ç»™çš„ Etag çš„å€¼ï¼ŒæœåŠ¡å™¨æ¯”å¯¹ä¸€ä¸‹èµ„æºå½“å‰çš„ Etag æ˜¯å¦è·Ÿ If-None-Match
ä¸€è‡´ï¼Œä¸ä¸€è‡´åˆ™è¯´æ˜èµ„æºä¿®æ”¹è¿‡äº†ï¼Œæµè§ˆå™¨ä¸èƒ½å†ä½¿ç”¨ç¼“å­˜ï¼Œå¦åˆ™æµè§ˆå™¨å¯ä»¥ç»§ç»­ä½¿ç”¨ç¼“å­˜ï¼Œå¹¶è¿”å› 304 çŠ¶æ€ç ã€‚</p><p><a href="http://nginx.org/en/docs/http/ngx_http_core_module.html#etag" target="_blank" rel="noopener noreferrer">nginx é…ç½® etag</a>
ç”±æ–‡ä»¶å†…å®¹çš„ hash æˆ–è€… mtime/size ç”Ÿæˆ</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="æœ€ä½³ç¼“å­˜ç­–ç•¥">æœ€ä½³ç¼“å­˜ç­–ç•¥<a class="hash-link" href="#æœ€ä½³ç¼“å­˜ç­–ç•¥" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ç¼“å­˜ä½ç½®">ç¼“å­˜ä½ç½®<a class="hash-link" href="#ç¼“å­˜ä½ç½®" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>è¯·æ±‚ä¸€ä¸ªèµ„æºæ—¶ï¼Œä¼šæŒ‰ç…§ä¼˜å…ˆçº§ï¼ˆService Worker - Memory Cache - Disk Cache - Push
Cacheï¼‰ä¾æ¬¡æŸ¥æ‰¾ç¼“å­˜ï¼Œå¦‚æœå‘½ä¸­åˆ™ä½¿ç”¨ç¼“å­˜ï¼Œå¦åˆ™å‘èµ·è¯·æ±‚ã€‚</p><ol><li>service walker</li></ol><p>æµè§ˆå™¨èƒŒåçš„ç‹¬ç«‹çº¿ç¨‹ï¼ŒService Worker ä¸­æ¶‰åŠåˆ°è¯·æ±‚æ‹¦æˆªï¼Œæ‰€ä»¥å¿…é¡»ä½¿ç”¨ HTTPS åè®®æ¥ä¿éšœå®‰å…¨</p><p>å½“ Service Worker æ²¡æœ‰å‘½ä¸­ç¼“å­˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å»è°ƒç”¨ fetch å‡½æ•°è·å–æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæˆ‘ä»¬æ²¡æœ‰åœ¨ Service Worker
å‘½ä¸­ç¼“å­˜çš„è¯ï¼Œä¼šæ ¹æ®ç¼“å­˜æŸ¥æ‰¾ä¼˜å…ˆçº§å»æŸ¥æ‰¾æ•°æ®ã€‚ä½†æ˜¯ä¸ç®¡æˆ‘ä»¬æ˜¯ä» Memory Cache ä¸­è¿˜æ˜¯ä»ç½‘ç»œè¯·æ±‚ä¸­è·å–çš„æ•°æ®ï¼Œæµè§ˆå™¨éƒ½ä¼šæ˜¾ç¤ºæˆ‘ä»¬æ˜¯ä» Service
Worker ä¸­è·å–çš„å†…å®¹ã€‚</p><ol start="2"><li>200 from memory cache</li></ol><p>ä¸»è¦åŒ…å«çš„æ˜¯å½“å‰ä¸­é¡µé¢ä¸­å·²ç»æŠ“å–åˆ°çš„èµ„æºï¼Œä¼šéšç€è¿›ç¨‹çš„é‡Šæ”¾è€Œé‡Šæ”¾ï¼Œä¸€æ—¦æˆ‘ä»¬å…³é—­ Tab é¡µé¢ï¼Œå†…å­˜ä¸­çš„ç¼“å­˜ä¹Ÿå°±è¢«é‡Šæ”¾äº†ã€‚
ä¸€èˆ¬æ¥è¯´ï¼Œç³»ç»Ÿä¸ä¼šç»™å†…å­˜åˆ†é…è¾ƒå¤§çš„å®¹é‡ï¼Œå› æ­¤å†…å­˜ç¼“å­˜ä¸€èˆ¬ç”¨äºå­˜å‚¨è¾ƒå°æ–‡ä»¶ã€‚åŒæ—¶å†…å­˜ç¼“å­˜åœ¨æœ‰æ—¶æ•ˆæ€§è¦æ±‚çš„åœºæ™¯ä¸‹ä¹Ÿå¾ˆæœ‰ç”¨ï¼ˆæ¯”å¦‚æµè§ˆå™¨çš„éšç§æ¨¡å¼ï¼‰ã€‚å½“å‰ç³»ç»Ÿå†…å­˜ä½¿ç”¨ç‡é«˜çš„è¯ï¼Œæ–‡ä»¶ä¼˜å…ˆå­˜å‚¨è¿›ç¡¬ç›˜</p><blockquote><p>è¿˜ä¿å­˜ç€ preload/prefetch ç›¸å…³çš„èµ„æºï¼Œpreloader çš„ç›¸å…³æŒ‡ä»¤å·²ç»æ˜¯é¡µé¢ä¼˜åŒ–çš„å¸¸è§æ‰‹æ®µä¹‹ä¸€ï¼Œå®ƒå¯ä»¥ä¸€è¾¹è§£æ js/css
æ–‡ä»¶ï¼Œä¸€è¾¹ç½‘ç»œè¯·æ±‚ä¸‹ä¸€ä¸ªèµ„æºã€‚200 from prefetch cache åœ¨ preload æˆ– prefetch çš„èµ„æºåŠ è½½æ—¶ï¼Œä¸¤è€…ä¹Ÿæ˜¯å‡å­˜å‚¨åœ¨
http cacheï¼Œå½“èµ„æºåŠ è½½å®Œæˆåï¼Œå¦‚æœèµ„æºæ˜¯å¯ä»¥è¢«ç¼“å­˜çš„ï¼Œé‚£ä¹ˆå…¶è¢«å­˜å‚¨åœ¨ http cache
ä¸­ç­‰å¾…åç»­ä½¿ç”¨ï¼›å¦‚æœèµ„æºä¸å¯è¢«ç¼“å­˜ï¼Œé‚£ä¹ˆå…¶åœ¨è¢«ä½¿ç”¨å‰å‡å­˜å‚¨åœ¨ memory cacheã€‚</p></blockquote><ol start="3"><li><p>200 from disk cache
è¡¨ç¤ºä¸è®¿é—®æœåŠ¡å™¨ï¼Œç›´æ¥ä»ç¡¬ç›˜ä¸­è¯»å–ç¼“å­˜ã€‚ä¸å†…å­˜ç›¸æ¯”ï¼Œç¡¬ç›˜çš„è¯»å–é€Ÿåº¦ç›¸å¯¹è¾ƒæ…¢ï¼Œä½†ç¡¬ç›˜ç¼“å­˜æŒç»­çš„æ—¶é—´æ›´é•¿ï¼Œå…³é—­è¿›ç¨‹ä¹‹åï¼Œç¼“å­˜çš„èµ„æºä»ç„¶å­˜åœ¨ã€‚ç”±äºç¡¬ç›˜çš„å®¹é‡è¾ƒå¤§ï¼Œå› æ­¤ä¸€èˆ¬ç”¨äºå­˜å‚¨å¤§æ–‡ä»¶ã€‚
å¯¹äºå¤§æ–‡ä»¶æ¥è¯´ï¼Œå¤§æ¦‚ç‡æ˜¯ä¸å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ï¼Œåä¹‹ä¼˜å…ˆ</p></li><li><p>Push cache</p></li></ol><p>Push Cacheï¼ˆæ¨é€ç¼“å­˜ï¼‰æ˜¯ HTTP/2
ä¸­çš„å†…å®¹ï¼Œå½“ä»¥ä¸Šä¸‰ç§ç¼“å­˜éƒ½æ²¡æœ‰å‘½ä¸­æ—¶ï¼Œå®ƒæ‰ä¼šè¢«ä½¿ç”¨ã€‚å®ƒåªåœ¨ä¼šè¯ï¼ˆSessionï¼‰ä¸­å­˜åœ¨ï¼Œä¸€æ—¦ä¼šè¯ç»“æŸå°±è¢«é‡Šæ”¾ï¼Œå¹¶ä¸”ç¼“å­˜æ—¶é—´ä¹Ÿå¾ˆçŸ­æš‚ï¼Œåœ¨ Chrome
æµè§ˆå™¨ä¸­åªæœ‰ 5 åˆ†é’Ÿå·¦å³ï¼ŒåŒæ—¶å®ƒä¹Ÿå¹¶éä¸¥æ ¼æ‰§è¡Œ HTTP å¤´ä¸­çš„ç¼“å­˜æŒ‡ä»¤ã€‚</p><ul><li>å¯ä»¥æ¨é€ no-cache å’Œ no-store çš„èµ„æº</li><li>ä¸€æ—¦è¿æ¥è¢«å…³é—­ï¼ŒPush Cache å°±è¢«é‡Šæ”¾</li><li>å¤šä¸ªé¡µé¢å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ª HTTP/2 çš„è¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨åŒä¸€ä¸ª Push Cacheï¼Œæœ‰çš„æµè§ˆå™¨ä¼šå¯¹ç›¸åŒåŸŸåä½†ä¸åŒçš„ tab æ ‡ç­¾ä½¿ç”¨åŒä¸€ä¸ª HTTP è¿æ¥ã€‚</li><li>Push Cache ä¸­çš„ç¼“å­˜åªèƒ½è¢«ä½¿ç”¨ä¸€æ¬¡</li><li>æµè§ˆå™¨å¯ä»¥æ‹’ç»æ¥å—å·²ç»å­˜åœ¨çš„èµ„æºæ¨é€</li><li>ä½ å¯ä»¥ç»™å…¶ä»–åŸŸåæ¨é€èµ„æº</li></ul><p>å…¶ä»–</p><ol><li>CDN Cache</li></ol><p>ä»¥è…¾è®¯ CDN ä¸ºä¾‹ï¼šX-Cache-Lookup:Hit From MemCache è¡¨ç¤ºå‘½ä¸­ CDN èŠ‚ç‚¹çš„å†…å­˜ï¼›X-Cache-Lookup:Hit
From Disktank è¡¨ç¤ºå‘½ä¸­ CDN èŠ‚ç‚¹çš„ç£ç›˜ï¼›X-Cache-Lookup:Hit From Upstream è¡¨ç¤ºæ²¡æœ‰å‘½ä¸­ CDNã€‚</p><ol start="2"><li>å…¶ä»–çš„ä¸å±•å¼€äº†ï¼Œå…·ä½“å‚è€ƒä¸‹é¢çš„ æ‰€æœ‰ç¼“å­˜æœºåˆ¶çš„è§£è¯»</li></ol><p>IndexDB(æµè§ˆå™¨æœ¬åœ°å­˜å‚¨)ï¼ŒService Workerï¼ŒLocalStorageï¼ŒSessionStorage</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="ç”¨æˆ·è¡Œä¸ºå¦‚ä½•è§¦å‘ç¼“å­˜ç­–ç•¥">ç”¨æˆ·è¡Œä¸ºå¦‚ä½•è§¦å‘ç¼“å­˜ç­–ç•¥<a class="hash-link" href="#ç”¨æˆ·è¡Œä¸ºå¦‚ä½•è§¦å‘ç¼“å­˜ç­–ç•¥" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><ol><li><p>æ‰“å¼€ç½‘é¡µï¼Œåœ°å€æ è¾“å…¥åœ°å€ï¼šæŸ¥æ‰¾ disk cache ä¸­æ˜¯å¦æœ‰åŒ¹é…ã€‚å¦‚æœ‰åˆ™ä½¿ç”¨ï¼›å¦‚æ²¡æœ‰åˆ™å‘é€ç½‘ç»œè¯·æ±‚ã€‚</p></li><li><p>æ™®é€šåˆ·æ–° (F5)ï¼šè·³è¿‡å¼ºç¼“å­˜ï¼Œä½†æ˜¯ä¼šæ£€æŸ¥åå•†ç¼“å­˜ (å› ä¸º TAB å¹¶æ²¡æœ‰å…³é—­ï¼Œå› æ­¤ memory cache æ˜¯å¯ç”¨çš„ï¼Œä¼šè¢«ä¼˜å…ˆä½¿ç”¨
(å¦‚æœåŒ¹é…çš„è¯)ã€‚å…¶æ¬¡æ‰æ˜¯ disk cache)ã€‚</p></li></ol><ul><li>å½“ä½ ç‚¹â€œåˆ·æ–°â€æŒ‰é’®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šåœ¨è¯·æ±‚å¤´é‡ŒåŠ ä¸€ä¸ªâ€œCache-Control: maxage=0â€ã€‚å› ä¸º max-age
æ˜¯â€œç”Ÿå­˜æ—¶é—´â€ï¼Œè€Œæœ¬åœ°ç¼“å­˜é‡Œçš„æ•°æ®è‡³å°‘ä¿å­˜äº†å‡ ç§’é’Ÿï¼Œæ‰€ä»¥æµè§ˆå™¨å°±ä¸ä¼šä½¿ç”¨ç¼“å­˜ï¼Œè€Œæ˜¯å‘æœåŠ¡å™¨å‘è¯·æ±‚ã€‚æœåŠ¡å™¨çœ‹åˆ°
max-age=0ï¼Œä¹Ÿå°±ä¼šç”¨ä¸€ä¸ªæœ€æ–°ç”Ÿæˆçš„æŠ¥æ–‡å›åº”æµè§ˆå™¨ã€‚</li></ul><ol start="3"><li>å¼ºåˆ¶åˆ·æ–° (Ctrl + F5)ï¼šæµè§ˆå™¨ä¸ä½¿ç”¨ç¼“å­˜ (è·³è¿‡å¼ºç¼“å­˜å’Œåå•†ç¼“å­˜)ï¼Œç›´æ¥ä»æœåŠ¡å™¨åŠ è½½ï¼Œå› æ­¤å‘é€çš„è¯·æ±‚å¤´éƒ¨å‡å¸¦æœ‰ Cache-control:
no-cache(ä¸ºäº†å…¼å®¹ï¼Œè¿˜å¸¦äº† Pragma: no-cache),æœåŠ¡å™¨ç›´æ¥è¿”å› 200 å’Œæœ€æ–°å†…å®¹ã€‚</li></ol><ul><li>â€œCache-Control: no-cacheâ€ï¼Œå«ä¹‰å’Œâ€œmax-age=0â€åŸºæœ¬ä¸€æ ·ï¼Œå°±çœ‹åå°çš„æœåŠ¡å™¨æ€ä¹ˆç†è§£ï¼Œé€šå¸¸ä¸¤è€…çš„æ•ˆæœæ˜¯ç›¸åŒçš„ã€‚</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="æœ€ä½³ç¼“å­˜ç­–ç•¥-1">æœ€ä½³ç¼“å­˜ç­–ç•¥<a class="hash-link" href="#æœ€ä½³ç¼“å­˜ç­–ç•¥-1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h4><p>å®šä¹‰æœ€ä¼˜ç¼“å­˜ç­–ç•¥</p><ul><li><p>æ›´æ–°é¢‘ç¹çš„åº”è¯¥æå–ä¸ºå•æ–‡ä»¶ï¼šæœ‰äº›èµ„æºçš„æ›´æ–°æ¯”å…¶ä»–èµ„æºé¢‘ç¹ã€‚å¦‚æœèµ„æºçš„ç‰¹å®šéƒ¨åˆ†ï¼ˆä¾‹å¦‚ JS å‡½æ•°æˆ–ä¸€ç»„ CSS
æ ·å¼ï¼‰ä¼šç»å¸¸æ›´æ–°ï¼Œåº”è€ƒè™‘å°†å…¶ä»£ç ä½œä¸ºå•ç‹¬çš„æ–‡ä»¶æä¾›ã€‚è¿™æ ·ï¼Œæ¯æ¬¡è·å–æ›´æ–°æ—¶ï¼Œå‰©ä½™å†…å®¹ï¼ˆä¾‹å¦‚ä¸ä¼šé¢‘ç¹æ›´æ–°çš„åº“ä»£ç ï¼‰å¯ä»¥ä»ç¼“å­˜ä¸­è·å–ï¼Œç¡®ä¿ä¸‹è½½çš„å†…å®¹é‡æœ€å°‘ï¼›</p></li><li><p>ç¡®ä¿æœåŠ¡å™¨é…ç½®æˆ–ç§»é™¤ ETagï¼šå› ä¸º Etag è·ŸæœåŠ¡å™¨é…ç½®æœ‰å…³ï¼Œæ¯å°æœåŠ¡å™¨çš„ Etag éƒ½æ˜¯ä¸åŒçš„ï¼›å…¶ä»–</p></li><li><p>ç¡®å®šä¸­ç»§ç¼“å­˜å¯ä»¥ç¼“å­˜å“ªäº›èµ„æºï¼šå¯¹æ‰€æœ‰ç”¨æˆ·çš„å“åº”å®Œå…¨ç›¸åŒçš„èµ„æºå¾ˆé€‚åˆç”± CDN æˆ–å…¶ä»–ä¸­ç»§ç¼“å­˜è¿›è¡Œç¼“å­˜ï¼›</p></li><li><p>ä½¿ç”¨ä¸€è‡´çš„ç½‘å€ï¼šå¦‚æœæ‚¨åœ¨ä¸åŒçš„ç½‘å€ä¸Šæä¾›ç›¸åŒçš„å†…å®¹ï¼Œå°†ä¼šå¤šæ¬¡è·å–å’Œå­˜å‚¨è¯¥å†…å®¹ã€‚æ³¨æ„ï¼šURL åŒºåˆ†å¤§å°å†™ï¼</p></li><li><p>ç¡®å®šæ¯ä¸ªèµ„æºçš„æœ€ä¼˜ç¼“å­˜å‘¨æœŸï¼šä¸åŒçš„èµ„æºå¯èƒ½æœ‰ä¸åŒçš„æ›´æ–°è¦æ±‚ã€‚å®¡æŸ¥å¹¶ç¡®å®šæ¯ä¸ªèµ„æºé€‚åˆçš„ max-ageï¼›</p></li><li><p>ç¡®å®šç½‘ç«™çš„æœ€ä½³ç¼“å­˜å±‚çº§ï¼šå¯¹ HTML æ–‡æ¡£ç»„åˆä½¿ç”¨åŒ…å«å†…å®¹ç‰¹å¾ç çš„èµ„æºç½‘å€ä»¥åŠçŸ­æ—¶é—´æˆ– no-cache çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¯ä»¥æ§åˆ¶å®¢æˆ·ç«¯è·å–æ›´æ–°çš„é€Ÿåº¦ï¼›</p></li><li><p>å–„ç”¨ HTML5 çš„ç¼“å­˜æœºåˆ¶ï¼šåˆç†è®¾è®¡å¯ç”¨ LocalStorageã€SessionStorageã€IndexDBã€SW ç­‰å­˜å‚¨ï¼Œä¼šç»™é¡µé¢æ€§èƒ½å¸¦æ¥æ˜æ˜¾æå‡ï¼›</p></li><li><p>ç”¨å¥½æœ¬åœ°ç¼“å­˜</p></li></ul><p><img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202130038910.png" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™<a class="hash-link" href="#å‚è€ƒèµ„æ–™" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li><a href="https://www.jiqizhixin.com/articles/2020-07-24-12" target="_blank" rel="noopener noreferrer">æ‰€æœ‰ç¼“å­˜æœºåˆ¶çš„è§£è¯»</a></li><li><a href="https://developer.huawei.com/consumer/cn/forum/topic/0202357360658600848" target="_blank" rel="noopener noreferrer">å‰ç«¯å­¦ä¹ ä¹‹æµè§ˆå™¨ç¼“å­˜æœºåˆ¶</a></li><li><a href="https://cloud.tencent.com/developer/news/588770" target="_blank" rel="noopener noreferrer">èµ„æ–™</a></li><li><a href="https://shanyue.tech/frontend-engineering/http-cache.html" target="_blank" rel="noopener noreferrer">å±±æœˆ</a></li><li><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Caching" target="_blank" rel="noopener noreferrer">MDN-caching</a></li><li><a href="https://zhuanlan.zhihu.com/p/111190645" target="_blank" rel="noopener noreferrer">ç¼“å­˜ç­–ç•¥ï¼šå¼ºç¼“å­˜&amp;åå•†ç¼“å­˜</a></li><li><a href="https://www.kancloud.cn/cyyspring/webpack/1836682" target="_blank" rel="noopener noreferrer">æ–‡ä»¶æŒ‡çº¹</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cookie-å’Œ-session-çš„åŒºåˆ«">cookie å’Œ session çš„åŒºåˆ«<a class="hash-link" href="#cookie-å’Œ-session-çš„åŒºåˆ«" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><p>1.ä½¿ç”¨æ–¹å¼</p><p>cookie æœºåˆ¶ï¼šå¦‚æœä¸åœ¨æµè§ˆå™¨ä¸­è®¾ç½®è¿‡æœŸäº‹ä»¶ï¼Œcookie è¢«ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œç”Ÿå‘½å‘¨æœŸéšæµè§ˆå™¨çš„å…³é—­è€Œç»“æŸï¼Œè¿™ç§ cookie ç®€ç§°ä¸ºä¼šè¯
cookieã€‚å¦‚æœåœ¨æµè§ˆå™¨ä¸­è®¾ç½®äº† cookie çš„è¿‡æœŸäº‹ä»¶ï¼Œcookie ä¼šè¢«ä¿å­˜åœ¨ç¡¬ç›˜ä¸­ï¼Œå…³é—­æµè§ˆå™¨åï¼Œcookie
æ•°æ®ä»ç„¶å­˜åœ¨ï¼Œç›´åˆ°è¿‡æœŸäº‹ä»¶ç»“æŸæ‰æ¶ˆå¤±ã€‚cookie æ˜¯æœåŠ¡ç«¯å‘ç»™å®¢æˆ·ç«¯çš„ç‰¹æ®Šä¿¡æ¯ï¼Œcookie æ˜¯ä»¥æ–‡æœ¬çš„æ–¹å¼ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œæ¯æ¬¡è¯·æ±‚æ—¶éƒ½å¸¦ä¸Šå®ƒ</p><p>session æœºåˆ¶ï¼šå½“æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚éœ€è¦åˆ›å»º session å¯¹è±¡æ—¶ï¼Œé¦–å…ˆä¼šæ£€æŸ¥å®¢æˆ·ç«¯è¯·æ±‚ä¸­æ˜¯å¦åŒ…å« sessionidã€‚å¦‚æœæœ‰
sessionidï¼ŒæœåŠ¡å™¨å°†æ ¹æ®è¯¥ id è¿”å›å¯¹åº” session å¯¹è±¡ã€‚å¦‚æœå®¢æˆ·ç«¯è¯·æ±‚ä¸­æ²¡æœ‰ sessionidï¼ŒæœåŠ¡å™¨ä¼šåˆ›å»ºæ–°çš„ session å¯¹è±¡ï¼Œå¹¶æŠŠ
sessionid åœ¨æœ¬æ¬¡å“åº”ä¸­è¿”å›ç»™å®¢æˆ·ç«¯ã€‚é€šå¸¸ä½¿ç”¨ cookie æ–¹å¼å­˜å‚¨ sessionid åˆ°å®¢æˆ·ç«¯ï¼Œåœ¨äº¤äº’ä¸­æµè§ˆå™¨æŒ‰ç…§è§„åˆ™å°† sessionid
å‘é€ç»™æœåŠ¡å™¨ã€‚å¦‚æœç”¨æˆ·ç¦ç”¨ cookieï¼Œåˆ™è¦ä½¿ç”¨ URL é‡å†™ï¼Œå¯ä»¥é€šè¿‡ response.encodeURL(url) è¿›è¡Œå®ç°ï¼›API å¯¹
encodeURL çš„ç»“æŸä¸ºï¼Œå½“æµè§ˆå™¨æ”¯æŒ cookie æ—¶ï¼Œurl ä¸åšä»»ä½•å¤„ç†ï¼›å½“æµè§ˆå™¨ä¸æ”¯æŒ cookie çš„æ—¶å€™ï¼Œå°†ä¼šé‡å†™ URL å°†
sessionid æ‹¼æ¥åˆ°è®¿é—®åœ°å€åã€‚</p><p>2.ä¿æŒçŠ¶æ€</p><p>cookie ä¿å­˜åœ¨æµè§ˆå™¨ç«¯ï¼Œsession ä¿å­˜åœ¨æœåŠ¡å™¨ç«¯</p><p>3.å­˜å‚¨çš„å¤§å°</p><p>å•ä¸ª cookie ä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡ 4kbï¼›session å¤§å°æ²¡æœ‰é™åˆ¶ã€‚</p><p>4.å­˜å‚¨å†…å®¹</p><p>cookie åªèƒ½ä¿å­˜å­—ç¬¦ä¸²ç±»å‹ï¼Œä»¥æ–‡æœ¬çš„æ–¹å¼ã€‚session é€šè¿‡ç±»ä¼¼ä¸ Hashtable çš„æ•°æ®ç»“æ„æ¥ä¿å­˜ï¼Œèƒ½æ”¯æŒä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ˆsession
ä¸­å¯å«æœ‰å¤šä¸ªå¯¹è±¡ï¼‰</p><p>5.å®‰å…¨æ€§</p><p>session çš„å®‰å…¨æ€§å¤§äº cookieã€‚åŸå› å¦‚ä¸‹ï¼š</p><p>â‘  sessionid å­˜å‚¨åœ¨ cookie ä¸­ï¼Œè‹¥è¦æ”»ç ´ session é¦–å…ˆè¦æ”»ç ´ cookieï¼› â‘¡ sessionid æ˜¯è¦æœ‰äººç™»å½•ï¼Œæˆ–è€…å¯åŠ¨
session_start æ‰ä¼šæœ‰ï¼Œæ‰€ä»¥æ”»ç ´ cookie ä¹Ÿä¸ä¸€å®šèƒ½å¾—åˆ° sessionidï¼› â‘¢ ç¬¬äºŒæ¬¡å¯åŠ¨ session_start åï¼Œå‰ä¸€æ¬¡çš„
sessionid å°±æ˜¯å¤±æ•ˆäº†ï¼Œsession è¿‡æœŸåï¼Œsessionid ä¹Ÿéšä¹‹å¤±æ•ˆã€‚ â‘£ sessionid æ˜¯åŠ å¯†çš„ã€‚</p><p>ç»¼ä¸Šæ‰€è¿°ï¼Œæ”»å‡»è€…å¿…é¡»åœ¨çŸ­æ—¶é—´å†…æ”»ç ´åŠ å¯†çš„ sessionidï¼Œè¿™å¾ˆéš¾ã€‚</p><p>6.åº”ç”¨åœºæ™¯</p><p>cookieï¼šï¼ˆ1ï¼‰åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•è¿‡ç½‘ç«™ï¼Œä»¥ä¾¿ä¸‹æ¬¡ç™»å½•æ—¶èƒ½å¤Ÿå®ç°è‡ªåŠ¨ç™»å½•ï¼ˆæˆ–è€…è®°ä½å¯†ç ï¼‰ã€‚ï¼ˆ2ï¼‰ä¿å­˜ä¸Šæ¬¡ç™»å½•çš„äº‹ä»¶ç­‰ä¿¡æ¯ã€‚ï¼ˆ3ï¼‰ä¿å­˜ä¸Šæ¬¡æŸ¥çœ‹çš„é¡µé¢
ï¼ˆ4ï¼‰æµè§ˆè®¡æ•°</p><p>sessionï¼š</p><p>ï¼ˆ1ï¼‰ç½‘ä¸Šå•†åŸä¸­çš„è´­ç‰©è½¦ï¼ˆ2ï¼‰ä¿å­˜ç”¨æˆ·ç™»å½•ä¿¡æ¯ï¼ˆ3ï¼‰å°†æŸäº›æ•°æ®æ”¾å…¥ session ä¸­ï¼Œä¾›åŒä¸€ç”¨æˆ·çš„ä¸åŒé¡µé¢ä½¿ç”¨ï¼ˆ4ï¼‰é˜²æ­¢ç”¨æˆ·éæ³•ç™»å½•</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="localstorage-å’Œ-sessionstorage-çš„åŒºåˆ«">localStorage å’Œ sessionStorage çš„åŒºåˆ«<a class="hash-link" href="#localstorage-å’Œ-sessionstorage-çš„åŒºåˆ«" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>1.ç”Ÿå‘½å‘¨æœŸ</p><p>localStorage çš„ç”Ÿå‘½å‘¨æœŸæ˜¯æ°¸ä¹…çš„ï¼Œå…³é—­é¡µé¢æˆ–æµè§ˆå™¨ä¹‹å localStorage ä¸­çš„æ•°æ®ä¹Ÿä¸ä¼šæ¶ˆå¤±ã€‚localStorage
é™¤éä¸»åŠ¨åˆ é™¤æ•°æ®ï¼Œå¦åˆ™æ•°æ®æ°¸è¿œä¸ä¼šæ¶ˆå¤±ã€‚</p><p>sessionStorage çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»…åœ¨å½“å‰ä¼šè¯ä¸‹æœ‰æ•ˆã€‚sessionStorage å¼•å…¥äº†ä¸€ä¸ªâ€œæµè§ˆå™¨çª—å£â€çš„æ¦‚å¿µï¼ŒsessionStorage
æ˜¯åœ¨åŒæºçš„çª—å£ä¸­å§‹ç»ˆå­˜åœ¨çš„æ•°æ®ã€‚åªè¦è¿™ä¸ªæµè§ˆå™¨çª—å£æ²¡æœ‰å…³é—­ï¼Œå³ä½¿åˆ·æ–°é¡µé¢æˆ–è€…è¿›å…¥åŒæºå¦ä¸€ä¸ªé¡µé¢ï¼Œæ•°æ®ä¾ç„¶å­˜åœ¨ã€‚ä½†æ˜¯ sessionStorage
åœ¨å…³é—­äº†æµè§ˆå™¨çª—å£åå°±ä¼šè¢«é”€æ¯ã€‚åŒæ—¶ç‹¬ç«‹çš„æ‰“å¼€åŒä¸€ä¸ªçª—å£åŒä¸€ä¸ªé¡µé¢ï¼ŒsessionStorage ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>2.å­˜å‚¨å¤§å°</p><p>localStorage å’Œ sessionStorage çš„å­˜å‚¨æ•°æ®å¤§å°ä¸€èˆ¬éƒ½æ˜¯ï¼š5MB</p><p>3.å­˜å‚¨ä½ç½®</p><p>localStorage å’Œ sessionStorage éƒ½ä¿å­˜åœ¨å®¢æˆ·ç«¯ï¼Œä¸ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’é€šä¿¡</p><p>4.å­˜å‚¨å†…å®¹ç±»å‹</p><p>localStorage å’Œ sessionStorage åªèƒ½å­˜å‚¨å­—ç¬¦ä¸²ç±»å‹ï¼Œå¯¹äºå¤æ‚çš„å¯¹è±¡å¯ä»¥ä½¿ç”¨ ECMAScript æä¾›çš„ JSON å¯¹è±¡çš„
stringify å’Œ parse æ¥å¤„ç†</p><p>5.åº”ç”¨åœºæ™¯</p><p>localStorageï¼šå¸¸ç”¨äºé•¿æœŸç™»å½•ï¼ˆ+ åˆ¤æ–­ç”¨æˆ·æ˜¯å¦å·²ç™»å½•ï¼‰ï¼Œé€‚åˆé•¿æœŸä¿å­˜åœ¨æœ¬åœ°çš„æ•°æ®</p><p>sessionStorageï¼šæ•æ„Ÿè´¦å·ä¸€æ¬¡æ€§ç™»å½•</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cookie-ä¸­çš„-httponly-çš„å±æ€§å’Œä½œç”¨">Cookie ä¸­çš„ httponly çš„å±æ€§å’Œä½œç”¨<a class="hash-link" href="#cookie-ä¸­çš„-httponly-çš„å±æ€§å’Œä½œç”¨" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><p>1.ä»€ä¹ˆæ˜¯ HttpOnly?</p><p>å¦‚æœ cookie ä¸­è®¾ç½®äº† HttpOnly å±æ€§ï¼Œé‚£ä¹ˆï¼Œè¿™æ ·èƒ½æœ‰æ•ˆçš„é˜²æ­¢ XSS æ”»å‡»ï¼Œçªƒå– cookie å†…å®¹ï¼Œè¿™æ ·å°±å¢åŠ äº† cookie
çš„å®‰å…¨æ€§ï¼Œå³ä¾¿æ˜¯è¿™æ ·ï¼Œä¹Ÿä¸è¦å°†é‡è¦ä¿¡æ¯å­˜å…¥ cookieã€‚XSS å…¨ç§° Cross SiteScriptï¼Œè·¨ç«™è„šæœ¬æ”»å‡»ï¼Œæ˜¯ Web ç¨‹åºä¸­å¸¸è§çš„æ¼æ´ï¼ŒXSS
å±äºè¢«åŠ¨å¼ä¸”ç”¨äºå®¢æˆ·ç«¯çš„æ”»å‡»æ–¹å¼ï¼Œæ‰€ä»¥å®¹æ˜“è¢«å¿½ç•¥å…¶å±å®³æ€§ã€‚å…¶åŸç†æ˜¯æ”»å‡»è€…å‘æœ‰ XSS æ¼æ´çš„ç½‘ç«™ä¸­è¾“å…¥ (ä¼ å…¥) æ¶æ„çš„ HTML
ä»£ç ï¼Œå½“å…¶å®ƒç”¨æˆ·æµè§ˆè¯¥ç½‘ç«™æ—¶ï¼Œè¿™æ®µ HTML ä»£ç ä¼šè‡ªåŠ¨æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ”»å‡»çš„ç›®çš„ã€‚å¦‚ï¼Œç›—å–ç”¨æˆ· Cookieã€ç ´åé¡µé¢ç»“æ„ã€é‡å®šå‘åˆ°å…¶å®ƒç½‘ç«™ç­‰ã€‚</p><p>2.HttpOnly çš„è®¾ç½®æ ·ä¾‹</p><p>response.setHeader(&quot;Set-Cookie&quot;,
&quot;cookiename=httponlyTest;Path=/;Domain=domainvalue;Max-Age=seconds;HTTPOnly&quot;);
ä¾‹å¦‚ï¼š //è®¾ç½® cookie</p><p>response.addHeader(&quot;Set-Cookie&quot;, &quot;uid=112; Path=/; HttpOnly&quot;)</p><p>//è®¾ç½®å¤šä¸ª cookie</p><p>response.addHeader(&quot;Set-Cookie&quot;, &quot;uid=112; Path=/; HttpOnly&quot;);</p><p>response.addHeader(&quot;Set-Cookie&quot;, &quot;timeout=30; Path=/test; HttpOnly&quot;);</p><p>//è®¾ç½® https çš„ cookie</p><p>response.addHeader(&quot;Set-Cookie&quot;, &quot;uid=112; Path=/; Secure; HttpOnly&quot;);</p><p>å…·ä½“å‚æ•°çš„å«ä¹‰å†æ¬¡ä¸åšé˜è¿°ï¼Œè®¾ç½®å®Œæ¯•åé€šè¿‡ js è„šæœ¬æ˜¯è¯»ä¸åˆ°è¯¥ cookie çš„ï¼Œä½†ä½¿ç”¨å¦‚ä¸‹æ–¹å¼å¯ä»¥è¯»å–ã€‚</p><p>Cookie cookies[]=request.getCookies();</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="å‚è€ƒèµ„æ–™-1">å‚è€ƒ/èµ„æ–™<a class="hash-link" href="#å‚è€ƒèµ„æ–™-1" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li><a href="https://github.com/xuexueq/blog/issues/5" target="_blank" rel="noopener noreferrer">æµè§ˆå™¨å­˜å‚¨æ–¹æ¡ˆï¼ˆCookieã€LocalStorageã€SessionStorageï¼‰</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="packagejson">package.json<a class="hash-link" href="#packagejson" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dependencies-ä¸-devdependencies-æœ‰ä½•åŒºåˆ«">dependencies ä¸ devDependencies æœ‰ä½•åŒºåˆ«<a class="hash-link" href="#dependencies-ä¸-devdependencies-æœ‰ä½•åŒºåˆ«" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ul><li>å¯¹äºä¸šåŠ¡ä»£ç ï¼Œæ‰“åŒ…æ—¶ä¾é çš„æ˜¯ bundle çš„ä¾èµ–åˆ†æï¼Œä¸ dev æ— å…³</li><li>å¯¹äºåº“è€Œè¨€ï¼Œå½“åº“è¢«å¼•å…¥æ—¶ï¼Œdev ä¸­çš„ä¾èµ–ä¸ä¼šè¢«ä¸‹è½½</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="cjsesumd">cjsã€esã€umd<a class="hash-link" href="#cjsesumd" title="æ ‡é¢˜çš„ç›´æ¥é“¾æ¥">â€‹</a></h3><ol><li>cjs æ˜¯åŠ¨æ€åŠ è½½æ¨¡å—ï¼Œå¯ä»¥ç›´æ¥ require ä¸€ä¸ªå˜é‡</li></ol><div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">require</span><span class="token punctuation" style="color:#393A34">(</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">./</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">${</span><span class="token template-string interpolation">a</span><span class="token template-string interpolation interpolation-punctuation punctuation" style="color:#393A34">}</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>esm æ˜¯è¯­è¨€ä¸Šçš„è§„èŒƒï¼Œå› æ­¤åœ¨ Node åŠ æµè§ˆå™¨ä¸­å‡ä¼šæ”¯æŒ</li></ol><ul><li>esm æ˜¯é™æ€å¯¼å…¥ï¼Œå¯ä»¥åœ¨ç¼–è¯‘æœŸè¿›è¡Œ Tree shakingï¼Œå‡å°‘ js ä½“ç§¯</li><li>å¦‚æœè¦åŠ¨æ€å¯¼å…¥ï¼Œå¯ä»¥<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> ms </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">await</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">import</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;https://cdn.skypack.dev/ms@latest&quot;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ms</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword module" style="color:#00009f">default</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="å¤åˆ¶ä»£ç åˆ°å‰ªè´´æ¿" title="å¤åˆ¶" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="æ–‡æ¡£åˆ†é¡µå¯¼èˆª"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/notes/frontend/flutter"><div class="pagination-nav__sublabel">ä¸Šä¸€é¡µ</div><div class="pagination-nav__label">flutter</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/notes/frontend/js_advanced"><div class="pagination-nav__sublabel">ä¸‹ä¸€é¡µ</div><div class="pagination-nav__label">JS è¿›é˜¶</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#å‹ç¼©" class="table-of-contents__link toc-highlight">å‹ç¼©</a><ul><li><a href="#åç«¯-gzip" class="table-of-contents__link toc-highlight">åç«¯ gzip</a></li><li><a href="#terser-å‹ç¼©" class="table-of-contents__link toc-highlight">terser å‹ç¼©</a></li><li><a href="#tree-shaking" class="table-of-contents__link toc-highlight">tree shaking</a></li></ul></li><li><a href="#http-ç¼“å­˜" class="table-of-contents__link toc-highlight">http ç¼“å­˜</a><ul><li><a href="#ä»‹ç»" class="table-of-contents__link toc-highlight">ä»‹ç»</a></li><li><a href="#cache-control" class="table-of-contents__link toc-highlight">Cache-Control</a></li><li><a href="#ä»€ä¹ˆæ˜¯æŒ‡çº¹" class="table-of-contents__link toc-highlight">ä»€ä¹ˆæ˜¯æŒ‡çº¹</a></li><li><a href="#æ–‡ä»¶æŒ‡çº¹ç”Ÿæˆç­–ç•¥" class="table-of-contents__link toc-highlight">æ–‡ä»¶æŒ‡çº¹ç”Ÿæˆç­–ç•¥</a></li><li><a href="#css-contenthash" class="table-of-contents__link toc-highlight">css-contenthash</a></li><li><a href="#æ°¸ä¹…ç¼“å­˜--å¼ºåˆ¶ç¼“å­˜-å¸¦æŒ‡çº¹" class="table-of-contents__link toc-highlight">æ°¸ä¹…ç¼“å­˜ / å¼ºåˆ¶ç¼“å­˜ (å¸¦æŒ‡çº¹)</a></li><li><a href="#åå•†ç¼“å­˜--å¯¹æ¯”ç¼“å­˜-ä¸å¸¦æŒ‡çº¹" class="table-of-contents__link toc-highlight">åå•†ç¼“å­˜ / å¯¹æ¯”ç¼“å­˜ (ä¸å¸¦æŒ‡çº¹)</a></li><li><a href="#etag-å’Œ-last-modified-çš„åŒºåˆ«" class="table-of-contents__link toc-highlight">Etag å’Œ Last-Modified çš„åŒºåˆ«</a></li><li><a href="#æœ€ä½³ç¼“å­˜ç­–ç•¥" class="table-of-contents__link toc-highlight">æœ€ä½³ç¼“å­˜ç­–ç•¥</a></li><li><a href="#å‚è€ƒèµ„æ–™" class="table-of-contents__link toc-highlight">å‚è€ƒèµ„æ–™</a></li></ul></li><li><a href="#cookie-å’Œ-session-çš„åŒºåˆ«" class="table-of-contents__link toc-highlight">cookie å’Œ session çš„åŒºåˆ«</a><ul><li><a href="#localstorage-å’Œ-sessionstorage-çš„åŒºåˆ«" class="table-of-contents__link toc-highlight">localStorage å’Œ sessionStorage çš„åŒºåˆ«</a></li><li><a href="#cookie-ä¸­çš„-httponly-çš„å±æ€§å’Œä½œç”¨" class="table-of-contents__link toc-highlight">Cookie ä¸­çš„ httponly çš„å±æ€§å’Œä½œç”¨</a></li><li><a href="#å‚è€ƒèµ„æ–™-1" class="table-of-contents__link toc-highlight">å‚è€ƒ/èµ„æ–™</a></li></ul></li><li><a href="#packagejson" class="table-of-contents__link toc-highlight">package.json</a><ul><li><a href="#dependencies-ä¸-devdependencies-æœ‰ä½•åŒºåˆ«" class="table-of-contents__link toc-highlight">dependencies ä¸ devDependencies æœ‰ä½•åŒºåˆ«</a></li><li><a href="#cjsesumd" class="table-of-contents__link toc-highlight">cjsã€esã€umd</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.143e3a9c.js"></script>
<script src="/assets/js/main.980f0465.js"></script>
</body>
</html>