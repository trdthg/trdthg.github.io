<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>bash - Trdthg&#x27;s Self</title>
                

        <!-- Custom HTML head -->
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

                <link rel="icon" href="../../favicon.svg">
                        <link rel="shortcut icon" href="../../favicon.png">
                <link rel="stylesheet" href="../../css/variables.css">
        <link rel="stylesheet" href="../../css/general.css">
        <link rel="stylesheet" href="../../css/chrome.css">
                <link rel="stylesheet" href="../../css/print.css" media="print">
        
        <!-- Fonts -->
        <link rel="stylesheet" href="../../FontAwesome/css/font-awesome.css">
                <link rel="stylesheet" href="../../fonts/fonts.css">
        
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../highlight.css">
        <link rel="stylesheet" href="../../tomorrow-night.css">
        <link rel="stylesheet" href="../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        
            </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">trans</li><li class="chapter-item expanded "><a href="../../trans/2022-04-20-译-使用-Tokio-处理-CPU-密集型任务.html"><strong aria-hidden="true">1.</strong> 2022-04-20-译-使用-Tokio-处理-CPU-密集型任务</a></li><li class="chapter-item expanded "><a href="../../trans/2023-01-03-译-Rust冒险:-滥用-Serde.html"><strong aria-hidden="true">2.</strong> 2023-01-03-译-Rust冒险:-滥用-Serde</a></li><li class="chapter-item expanded "><a href="../../trans/2023-01-01-译-拓展-Rust-中的-Map.html"><strong aria-hidden="true">3.</strong> 2023-01-01-译-拓展-Rust-中的-Map</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-01-译-search_engine.html"><strong aria-hidden="true">4.</strong> 2022-04-01-译-search_engine</a></li><li class="chapter-item expanded "><a href="../../trans/2022-05-04-译-可视化-Rust-各数据类型的内存布局.html"><strong aria-hidden="true">5.</strong> 2022-05-04-译-可视化-Rust-各数据类型的内存布局</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-13-译-tail_latency.html"><strong aria-hidden="true">6.</strong> 2022-04-13-译-tail_latency</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-30-译-什么时候不应该使用-Rust-？.html"><strong aria-hidden="true">7.</strong> 2022-04-30-译-什么时候不应该使用-Rust-？</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-11-译-异步-Rust：协作与抢占式调度.html"><strong aria-hidden="true">8.</strong> 2022-04-11-译-异步-Rust：协作与抢占式调度</a></li><li class="chapter-item expanded "><a href="../../trans/2023-01-02-译-未初始化内存:-unsafe-Rust太难了.html"><strong aria-hidden="true">9.</strong> 2023-01-02-译-未初始化内存:-unsafe-Rust太难了</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/index.html"><strong aria-hidden="true">10.</strong> 2022-04-03-译-Rust-六边形架构</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/Rust-六边形架构-4-重构.html"><strong aria-hidden="true">10.1.</strong> Rust-六边形架构-4-重构</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/Rust-六边形架构-2-内存存储库.html"><strong aria-hidden="true">10.2.</strong> Rust-六边形架构-2-内存存储库</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/Rust-六边形架构-7-长期存储库.html"><strong aria-hidden="true">10.3.</strong> Rust-六边形架构-7-长期存储库</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/Rust-六边形架构-1-域.html"><strong aria-hidden="true">10.4.</strong> Rust-六边形架构-1-域</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/Rust-六边形架构-5-其他用例.html"><strong aria-hidden="true">10.5.</strong> Rust-六边形架构-5-其他用例</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/Rust-六边形架构-6-CLI.html"><strong aria-hidden="true">10.6.</strong> Rust-六边形架构-6-CLI</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/Rust-六边形架构-3-HTTP-API.html"><strong aria-hidden="true">10.7.</strong> Rust-六边形架构-3-HTTP-API</a></li><li class="chapter-item expanded "><a href="../../trans/2022-04-03-译-Rust-六边形架构/index.html"><strong aria-hidden="true">10.8.</strong> README</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">note</li><li class="chapter-item expanded "><a href="../../note/java/index.html"><strong aria-hidden="true">11.</strong> java</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../note/java/java.html"><strong aria-hidden="true">11.1.</strong> java</a></li><li class="chapter-item expanded "><a href="../../note/java/springboot.html"><strong aria-hidden="true">11.2.</strong> springboot</a></li><li class="chapter-item expanded "><a href="../../note/java/spring.html"><strong aria-hidden="true">11.3.</strong> spring</a></li><li class="chapter-item expanded "><a href="../../note/java/sourceread.html"><strong aria-hidden="true">11.4.</strong> sourceread</a></li><li class="chapter-item expanded "><a href="../../note/java/index.html"><strong aria-hidden="true">11.5.</strong> README</a></li></ol></li><li class="chapter-item expanded "><a href="../../note/frontend/index.html"><strong aria-hidden="true">12.</strong> frontend</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../note/frontend/mini_bundle.html"><strong aria-hidden="true">12.1.</strong> mini_bundle</a></li><li class="chapter-item expanded "><a href="../../note/frontend/js_advanced.html"><strong aria-hidden="true">12.2.</strong> js_advanced</a></li><li class="chapter-item expanded "><a href="../../note/frontend/mini_vue.html"><strong aria-hidden="true">12.3.</strong> mini_vue</a></li><li class="chapter-item expanded "><a href="../../note/frontend/vue.html"><strong aria-hidden="true">12.4.</strong> vue</a></li><li class="chapter-item expanded "><a href="../../note/frontend/list.html"><strong aria-hidden="true">12.5.</strong> list</a></li><li class="chapter-item expanded "><a href="../../note/frontend/http.html"><strong aria-hidden="true">12.6.</strong> http</a></li><li class="chapter-item expanded "><a href="../../note/frontend/flutter.html"><strong aria-hidden="true">12.7.</strong> flutter</a></li><li class="chapter-item expanded "><a href="../../note/frontend/css.html"><strong aria-hidden="true">12.8.</strong> css</a></li><li class="chapter-item expanded "><a href="../../note/frontend/vdom.html"><strong aria-hidden="true">12.9.</strong> vdom</a></li><li class="chapter-item expanded "><a href="../../note/frontend/index.html"><strong aria-hidden="true">12.10.</strong> README</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">blog</li><li class="chapter-item expanded "><a href="../../blog/index.html"><strong aria-hidden="true">13.</strong> README</a></li><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">docs</li><li class="chapter-item expanded "><a href="../../docs/log.html"><strong aria-hidden="true">14.</strong> log</a></li><li class="chapter-item expanded "><a href="../../docs/intro.html"><strong aria-hidden="true">15.</strong> intro</a></li><li class="chapter-item expanded "><a href="../../docs/magic/index.html"><strong aria-hidden="true">16.</strong> magic</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../docs/magic/riscv.html"><strong aria-hidden="true">16.1.</strong> riscv</a></li><li class="chapter-item expanded "><a href="../../docs/magic/haskell.html"><strong aria-hidden="true">16.2.</strong> haskell</a></li><li class="chapter-item expanded "><a href="../../docs/magic/bash.html" class="active"><strong aria-hidden="true">16.3.</strong> bash</a></li><li class="chapter-item expanded "><a href="../../docs/magic/memory_ordering.html"><strong aria-hidden="true">16.4.</strong> memory_ordering</a></li><li class="chapter-item expanded "><a href="../../docs/magic/linuxIO.html"><strong aria-hidden="true">16.5.</strong> linuxIO</a></li><li class="chapter-item expanded "><a href="../../docs/magic/cicd.html"><strong aria-hidden="true">16.6.</strong> cicd</a></li><li class="chapter-item expanded "><a href="../../docs/magic/fd.html"><strong aria-hidden="true">16.7.</strong> fd</a></li><li class="chapter-item expanded "><a href="../../docs/magic/hadoop.html"><strong aria-hidden="true">16.8.</strong> hadoop</a></li><li class="chapter-item expanded "><a href="../../docs/magic/go.html"><strong aria-hidden="true">16.9.</strong> go</a></li><li class="chapter-item expanded "><a href="../../docs/magic/async.html"><strong aria-hidden="true">16.10.</strong> async</a></li><li class="chapter-item expanded "><a href="../../docs/magic/index.html"><strong aria-hidden="true">16.11.</strong> README</a></li><li class="chapter-item expanded "><a href="../../docs/magic/software_arch.html"><strong aria-hidden="true">16.12.</strong> software_arch</a></li></ol></li><li class="chapter-item expanded "><a href="../../docs/riscv/index.html"><strong aria-hidden="true">17.</strong> riscv</a></li><li class="chapter-item expanded "><a href="../../docs/common/index.html"><strong aria-hidden="true">18.</strong> common</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../docs/common/pgsql.html"><strong aria-hidden="true">18.1.</strong> pgsql</a></li><li class="chapter-item expanded "><a href="../../docs/common/git.html"><strong aria-hidden="true">18.2.</strong> git</a></li><li class="chapter-item expanded "><a href="../../docs/common/linux.html"><strong aria-hidden="true">18.3.</strong> linux</a></li><li class="chapter-item expanded "><a href="../../docs/common/datastructure.html"><strong aria-hidden="true">18.4.</strong> datastructure</a></li><li class="chapter-item expanded "><a href="../../docs/common/docker.html"><strong aria-hidden="true">18.5.</strong> docker</a></li><li class="chapter-item expanded "><a href="../../docs/common/analyze.html"><strong aria-hidden="true">18.6.</strong> analyze</a></li><li class="chapter-item expanded "><a href="../../docs/common/oci.html"><strong aria-hidden="true">18.7.</strong> oci</a></li><li class="chapter-item expanded "><a href="../../docs/common/unsorted.html"><strong aria-hidden="true">18.8.</strong> unsorted</a></li><li class="chapter-item expanded "><a href="../../docs/common/oauth2.html"><strong aria-hidden="true">18.9.</strong> oauth2</a></li><li class="chapter-item expanded "><a href="../../docs/common/vim.html"><strong aria-hidden="true">18.10.</strong> vim</a></li><li class="chapter-item expanded "><a href="../../docs/common/python.html"><strong aria-hidden="true">18.11.</strong> python</a></li><li class="chapter-item expanded "><a href="../../docs/common/index.html"><strong aria-hidden="true">18.12.</strong> README</a></li></ol></li><li class="chapter-item expanded "><a href="../../docs/rust/index.html"><strong aria-hidden="true">19.</strong> rust</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../docs/rust/mini_tokio.html"><strong aria-hidden="true">19.1.</strong> mini_tokio</a></li><li class="chapter-item expanded "><a href="../../docs/rust/wasm.html"><strong aria-hidden="true">19.2.</strong> wasm</a></li><li class="chapter-item expanded "><a href="../../docs/rust/rust_quiz.html"><strong aria-hidden="true">19.3.</strong> rust_quiz</a></li><li class="chapter-item expanded "><a href="../../docs/rust/rust.html"><strong aria-hidden="true">19.4.</strong> rust</a></li><li class="chapter-item expanded "><a href="../../docs/rust/print_into_detail.html"><strong aria-hidden="true">19.5.</strong> print_into_detail</a></li><li class="chapter-item expanded "><a href="../../docs/rust/net-piercer.html"><strong aria-hidden="true">19.6.</strong> net-piercer</a></li><li class="chapter-item expanded "><a href="../../docs/rust/rs_channel.html"><strong aria-hidden="true">19.7.</strong> rs_channel</a></li><li class="chapter-item expanded "><a href="../../docs/rust/lists.html"><strong aria-hidden="true">19.8.</strong> lists</a></li><li class="chapter-item expanded "><a href="../../docs/rust/index.html"><strong aria-hidden="true">19.9.</strong> README</a></li></ol></li><li class="chapter-item expanded "><a href="../../docs/riscv/index.html"><strong aria-hidden="true">20.</strong> riscv</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../docs/riscv/index.html"><strong aria-hidden="true">20.1.</strong> README</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">other</li><li class="chapter-item expanded "><a href="../../other/2023-04-12-remote-usb.html"><strong aria-hidden="true">21.</strong> 2023-04-12-remote-usb</a></li><li class="chapter-item expanded "><a href="../../other/resources.html"><strong aria-hidden="true">22.</strong> resources</a></li><li class="chapter-item expanded "><a href="../../other/i3wm.html"><strong aria-hidden="true">23.</strong> i3wm</a></li><li class="chapter-item expanded "><a href="../../other/lsm.html"><strong aria-hidden="true">24.</strong> lsm</a></li><li class="chapter-item expanded "><a href="../../other/site_update_log.html"><strong aria-hidden="true">25.</strong> site_update_log</a></li><li class="chapter-item expanded "><a href="../../other/ioclub/index.html"><strong aria-hidden="true">26.</strong> ioclub</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../other/ioclub/share_1.html"><strong aria-hidden="true">26.1.</strong> share_1</a></li><li class="chapter-item expanded "><a href="../../other/ioclub/index.html"><strong aria-hidden="true">26.2.</strong> README</a></li></ol></li><li class="chapter-item expanded "><a href="../../other/2021-后端/index.html"><strong aria-hidden="true">27.</strong> 2021-后端</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../other/2021-后端/backend_1.html"><strong aria-hidden="true">27.1.</strong> backend_1</a></li><li class="chapter-item expanded "><a href="../../other/2021-后端/backend_2.html"><strong aria-hidden="true">27.2.</strong> backend_2</a></li><li class="chapter-item expanded "><a href="../../other/2021-后端/backend_3.html"><strong aria-hidden="true">27.3.</strong> backend_3</a></li><li class="chapter-item expanded "><a href="../../other/2021-后端/backend_4.html"><strong aria-hidden="true">27.4.</strong> backend_4</a></li></ol></li><li class="chapter-item expanded "><a href="../../other/2021-后端/index.html"><strong aria-hidden="true">28.</strong> 2021-后端</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../other/2021-后端/backend_1.html"><strong aria-hidden="true">28.1.</strong> backend_1</a></li><li class="chapter-item expanded "><a href="../../other/2021-后端/backend_2.html"><strong aria-hidden="true">28.2.</strong> backend_2</a></li><li class="chapter-item expanded "><a href="../../other/2021-后端/backend_3.html"><strong aria-hidden="true">28.3.</strong> backend_3</a></li><li class="chapter-item expanded "><a href="../../other/2021-后端/backend_4.html"><strong aria-hidden="true">28.4.</strong> backend_4</a></li><li class="chapter-item expanded "><a href="../../other/2021-后端/index.html"><strong aria-hidden="true">28.5.</strong> README</a></li><li class="spacer"></li></ol></li><li class="chapter-item expanded "><li class="part-title">draft</li><li class="chapter-item expanded "><a href="../../draft/组成原理.html"><strong aria-hidden="true">29.</strong> 组成原理</a></li><li class="chapter-item expanded "><a href="../../draft/计算机网络.html"><strong aria-hidden="true">30.</strong> 计算机网络</a></li><li class="chapter-item expanded "><a href="../../draft/译-pkg_mng.html"><strong aria-hidden="true">31.</strong> 译-pkg_mng</a></li><li class="chapter-item expanded "><a href="../../draft/DistributedSystem.html"><strong aria-hidden="true">32.</strong> DistributedSystem</a></li><li class="chapter-item expanded "><a href="../../draft/oscamp2022.html"><strong aria-hidden="true">33.</strong> oscamp2022</a></li><li class="chapter-item expanded "><a href="../../draft/compile.html"><strong aria-hidden="true">34.</strong> compile</a></li><li class="chapter-item expanded "><a href="../../draft/test.html"><strong aria-hidden="true">35.</strong> test</a></li><li class="chapter-item expanded "><a href="../../draft/ld.html"><strong aria-hidden="true">36.</strong> ld</a></li><li class="chapter-item expanded "><a href="../../draft/数据库设计.html"><strong aria-hidden="true">37.</strong> 数据库设计</a></li><li class="chapter-item expanded "><a href="../../draft/index.html"><strong aria-hidden="true">38.</strong> README</a></li><li class="chapter-item expanded "><a href="../../draft/computer_network/index.html"><strong aria-hidden="true">39.</strong> computer_network</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../draft/computer_network/index.html"><strong aria-hidden="true">39.1.</strong> README</a></li></ol></li></ol>            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                                                <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                                            </div>

                    <h1 class="menu-title">Trdthg&#x27;s Self</h1>

                    <div class="right-buttons">
                                                <a href="../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                                                                        
                    </div>
                </div>

                                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bash"><a class="header" href="#bash">Bash</a></h1>
<h2 id="set-指令"><a class="header" href="#set-指令">set 指令</a></h2>
<pre><code class="language-sh"># 写法一
set -euxo pipefail

# 写法二
set -eux
set -o pipefail
</code></pre>
<p>另一种办法是在执行 Bash 脚本的时候，从命令行传入这些参数。</p>
<pre><code class="language-sh">bash -euxo pipefail script.sh
</code></pre>
<ul>
<li><code>-e</code></li>
</ul>
<p>等价于：<code>-o errexit</code></p>
<p>它使得脚本只要发生错误，就终止执行。</p>
<p><code>set +e</code> 可以关闭 <code>-e</code> 选项，之后你可以使用 <code>set -e</code> 重新打开</p>
<p>还有一种方法是使用 <code>command || true</code>，使得该命令即使执行失败，脚本也不会终止执行。</p>
<ul>
<li><code>-u</code></li>
</ul>
<p>等价于：<code>set -o nounset</code></p>
<p>遇到不存在的变量就会报错，并停止执行。</p>
<pre><code class="language-sh">$ bash script.sh
bash: script.sh:行4: a: 未绑定的变量
</code></pre>
<ul>
<li><code>-x</code></li>
</ul>
<p>等价于：<code>set -o xtrace</code></p>
<p>打印当前执行的命令</p>
<pre><code class="language-sh">$ bash -c &quot;set -x; echo a; echo b; echo 3&quot;
- echo a
a
- echo b
b
- echo 3
3
</code></pre>
<ul>
<li><code>set -o pipefail</code></li>
</ul>
<p><code>set -e</code> 不适用于管道命令。只要最后一个子命令不失败，管道命令总是会执行成功，因此它后面命令依然会执行，set -e 就失效了。</p>
<p>例如：<code>foo | echo a</code></p>
<p><code>set -o pipefail</code> 用来解决这种情况，只要一个子命令失败，整个管道命令就失败，脚本就会终止执行。</p>
<ul>
<li>不加参数</li>
</ul>
<p>如果命令行下不带任何参数，直接运行 set，会显示所有的环境变量和 Shell 函数。</p>
<h2 id="错误处理"><a class="header" href="#错误处理">错误处理</a></h2>
<p>如果脚本里面有运行失败的命令（返回值非 0），执行时会报错。但是，Bash 会忽略这个错误，继续往下执行。</p>
<p>如果某个命令失败，需要脚本停止执行，一般采用下面的写法。</p>
<pre><code class="language-sh">command || exit 1
</code></pre>
<p>上面的写法表示只要 command 有非零返回值，脚本就会停止执行。</p>
<p>如果停止执行之前需要完成多个操作，就要采用下面三种写法。</p>
<pre><code class="language-sh"># 写法一
command || { echo &quot;command failed&quot;; exit 1; }

# 写法二
if ! command; then echo &quot;command failed&quot;; exit 1; fi

# 写法三
command
if [ &quot;$?&quot; -ne 0 ]; then echo &quot;command failed&quot;; exit 1; fi
</code></pre>
<p>另外，除了停止执行，还有一种情况。如果两个命令有继承关系，只有第一个命令成功了，才能继续执行第二个命令，那么就要采用下面的写法。</p>
<pre><code class="language-sh">command1 &amp;&amp; command2
</code></pre>
<h2 id="变量"><a class="header" href="#变量">变量</a></h2>
<h3 id="定义"><a class="header" href="#定义">定义</a></h3>
<pre><code class="language-sh"># 普通变量
myUrl=&quot;abcd&quot;

# 只读变量
readonly myUrl=&quot;abcd&quot;
</code></pre>
<p>注意事项</p>
<ul>
<li>
<p>变量定义的等号两边<strong>不能有空格</strong></p>
</li>
<li>
<p>使用变量时 变量名外面的花括号是可选的</p>
<pre><code class="language-sh">for skill in Ada Coffee Action Java; do
  echo &quot;I am good at ${skill}Script&quot;
done
</code></pre>
</li>
<li>
<p>使用 <code>unset</code> 删除变量</p>
</li>
</ul>
<h3 id="字符串"><a class="header" href="#字符串">字符串</a></h3>
<ul>
<li>获取长度</li>
</ul>
<pre><code class="language-sh">echo &quot;length: ${#myUrl}&quot;
</code></pre>
<ul>
<li>获取切片</li>
</ul>
<pre><code class="language-sh">echo &quot;length: ${myUrl:1:4}&quot;
</code></pre>
<ul>
<li>第一次出现的索引</li>
</ul>
<pre><code class="language-sh">string=&quot;runoob is a great site&quot;
echo `expr index &quot;$string&quot; r`  # 输出 1
echo `expr index &quot;$string&quot; u`  # 输出 2
echo `expr index &quot;$string&quot; un`  # 输出 2
</code></pre>
<h3 id="数组"><a class="header" href="#数组">数组</a></h3>
<pre><code class="language-sh">array=(value0 garabe value2 value3)
array[1]=value1

echo ${array[1]}
echo ${array[@]} # 读取所有

# 读取长度
length=${#array_name[@]}
# 或者
length=${#array_name[*]}
</code></pre>
<p>bash 里的数组和字典较为类似，如果不指定，那么每个元素对应的键就是索引</p>
<pre><code class="language-sh">dict=()
# declare dict
# declare -A dict
dict[&quot;a&quot;]=1
echo ${dict[&quot;a&quot;]}
# 1
</code></pre>
<h2 id="参数"><a class="header" href="#参数">参数</a></h2>
<h3 id="-相关"><a class="header" href="#-相关"><code>$</code> 相关</a></h3>
<ol>
<li>
<p>参数相关</p>
<ul>
<li>
<p><strong><code>$#</code></strong>:传递到脚本的参数个数</p>
<p>下面两个常用来遍历所有参数</p>
</li>
<li>
<p><strong><code>$@</code></strong>: 与 <strong><code>$*</code></strong> 相同，但是使用时加引号，并在引号中返回每个参数。</p>
<p>如 <code>$@</code> 用 <code>「&quot;」</code> 括起来的情况、以 <code>&quot;$1&quot; &quot;$2&quot; … &quot;$n&quot;</code> 的形式输出所有参数。</p>
<pre><code class="language-sh">for i in &quot;$*&quot;; do
    echo $i
done
# 1 2 3

for i in &quot;$@&quot;; do
    echo $i
done

# 1
# 2
# 3
</code></pre>
</li>
<li>
<p><code>$_</code>: 拼接所有参数并返回。</p>
<p>如 <code>$_</code> 用 <code>「&quot;」</code> 括起来的情况、以 <code>&quot;$1 $2 … $n&quot;</code> 的形式输出所有参数。</p>
</li>
</ul>
</li>
<li>
<p>进程 ID 相关</p>
<ul>
<li><code>$$</code>: 脚本运行的当前进程 ID 号</li>
<li><code>$!</code>: 后台运行的最后一个进程的 ID 号</li>
<li><code>$-</code>: 显示 Shell 使用的当前选项，与 set 命令功能相同。</li>
<li><code>$?</code>: 显示最后命令的退出状态。0 表示没有错误，其他任何值表明有错误。</li>
</ul>
</li>
</ol>
<h2 id="运算符"><a class="header" href="#运算符">运算符</a></h2>
<p>原生 bash 不支持数学运算，但是可以通过其他命令实现，例如 awk 和 expr</p>
<pre><code class="language-sh">val=`expr 2 + 2`
echo &quot;两数之和为 : $val&quot;
</code></pre>
<h3 id="算数运算符"><a class="header" href="#算数运算符">算数运算符</a></h3>
<p><code>+ - * / % = == !=</code></p>
<p><strong>注意 :</strong></p>
<ul>
<li>
<p>表达式和运算符之间必须有空格</p>
</li>
<li>
<p>表达式必须要被 `` 包含</p>
</li>
<li>
<p>注意要转义 <code>*</code> 号</p>
<pre><code class="language-sh">val=`expr $a \* $b`
echo &quot;a * b : $val&quot;
</code></pre>
<blockquote>
<p>在 MAC 中 shell 的 expr 语法是：$((表达式))，此处表达式中的 &quot;*&quot; 不需要转义符号 &quot;&quot; 。</p>
</blockquote>
</li>
<li>
<p>判断的中括号两侧必须有空格</p>
<pre><code class="language-sh">if [ $a == $b ]
then
  echo &quot;a 等于 b&quot;
fi
if [ $a != $b ]
then
  echo &quot;a 不等于 b&quot;
fi
</code></pre>
</li>
</ul>
<h3 id="关系运算符"><a class="header" href="#关系运算符">关系运算符</a></h3>
<p>关系运算符只支持数字，不支持字符串，除非字符串的值是数字。</p>
<p><code>-eq -ne -gt -lt -ge -le</code></p>
<h3 id="布尔运算符"><a class="header" href="#布尔运算符">布尔运算符</a></h3>
<p><code>! (非)  -o (或)  -a (与)</code></p>
<h3 id="逻辑运算符"><a class="header" href="#逻辑运算符">逻辑运算符</a></h3>
<p><code>&amp;&amp; ||</code></p>
<h3 id="字符串运算符"><a class="header" href="#字符串运算符">字符串运算符</a></h3>
<ul>
<li>
<p><code>==</code>: 相等</p>
</li>
<li>
<p><code>!=</code>: 不相等</p>
</li>
<li>
<p><code>$</code>: 字符串是否不为空</p>
<pre><code class="language-sh">if [ $a ]
</code></pre>
</li>
<li>
<p><code>-z</code>: 长度是否为 0</p>
<pre><code class="language-sh">if [ -z $a ]
</code></pre>
</li>
<li>
<p><code>-n</code>: 长度是否不为 0</p>
</li>
</ul>
<h3 id="文件测试运算符"><a class="header" href="#文件测试运算符">文件测试运算符</a></h3>
<p>常用</p>
<ul>
<li>
<p><code>-e</code>: 检测文件（包括目录）是否存在</p>
</li>
<li>
<p><code>-s</code>: 检测文件是否为空（文件大小是否大于 0）</p>
</li>
<li>
<p><code>-f</code>: 检测文件是否是普通文件（既不是目录，也不是设备文件）</p>
</li>
<li>
<p><code>-d</code>: 检测文件是否是目录</p>
</li>
<li>
<p><code>-r</code>: 检测文件是否可读</p>
</li>
<li>
<p><code>-w</code>: 检测文件是否可写</p>
</li>
<li>
<p><code>-x</code>: 检测文件是否可执行</p>
</li>
</ul>
<p>其他</p>
<ul>
<li><code>-b</code>: 检测文件是否是块设备文件</li>
<li><code>-c</code>: 检测文件是否是字符设备文件</li>
<li><code>-g</code>: 检测文件是否设置了 SGID 位</li>
<li><code>-k</code>: 检测文件是否设置了粘着位 (Sticky Bit)</li>
<li><code>-p</code>: 检测文件是否是有名管道</li>
<li><code>-u</code>: 检测文件是否设置了 SUID 位</li>
<li><code>-S</code>: 判断某文件是否 socket。</li>
<li><code>-L</code>: 检测文件是否存在并且是一个符号链接。</li>
</ul>
<h2 id="流程控制"><a class="header" href="#流程控制">流程控制</a></h2>
<h3 id="if"><a class="header" href="#if">if</a></h3>
<p>if 语句语法格式：</p>
<pre><code class="language-sh">if [ &quot;$a&quot; -gt &quot;$b&quot; ]; then
    command1
elif (( a &gt; b )); then
    command2
else
    commandN
fi
</code></pre>
<ul>
<li>if else 的 <code>[...]</code> 判断语句中大于使用 <code>-gt</code>，小于使用 <code>-lt</code>。</li>
<li>如果使用 <code>((...))</code> 作为判断语句，大于和小于可以直接使用 <code>&gt;</code> 和 <code>&lt;</code>。</li>
<li>也可以使用 test</li>
</ul>
<blockquote>
<p>注意：所有分支都不能为空</p>
</blockquote>
<p>写成一行（适用于终端命令提示符）：</p>
<pre><code class="language-sh">if [ $(ps -ef | grep -c &quot;ssh&quot;) -gt 1 ]; then echo &quot;true&quot;; fi
</code></pre>
<h3 id="for-循环"><a class="header" href="#for-循环">for 循环</a></h3>
<pre><code class="language-sh">for var in item1 item2 ... itemN
do
    command1
    command2
    ...
    commandN
done
</code></pre>
<p>写成一行：</p>
<pre><code class="language-sh">for var in item1 item2 ... itemN; do command1; command2… done;
</code></pre>
<p>支持 break 和 continue 语句</p>
<pre><code class="language-sh">while : # 无限循环
do
    echo -n &quot;输入 1 到 5 之间的数字:&quot;
    read aNum # 获取用户输入
    case $aNum in
        # 可以匹配多个模式
        1|2|3|4|5) echo &quot;你输入的数字为 $aNum!&quot;
        ;;
        *) echo &quot;你输入的数字不是 1 到 5 之间的! 游戏结束&quot;
            break
        ;;
    esac
done
</code></pre>
<p>示例</p>
<pre><code class="language-sh">for loop in 1 2 3 4 5
do
    echo &quot;The value is: $loop&quot;
done

for str in This is a string
do
    echo $str
done
</code></pre>
<h3 id="while"><a class="header" href="#while">while</a></h3>
<pre><code class="language-sh">int=1
while(( $int&lt;=5 ))
do
    echo $int
    let &quot;int++&quot;
done
</code></pre>
<blockquote>
<p>let 命令，它用于执行一个或多个表达式，变量计算中不需要加上 $ 来表示变量</p>
</blockquote>
<h3 id="无限循环"><a class="header" href="#无限循环">无限循环</a></h3>
<p>无限循环语法格式：</p>
<pre><code class="language-sh">while :
do
    command
done
</code></pre>
<p>或者</p>
<pre><code class="language-sh">while true
do
    command
done
</code></pre>
<p>或者</p>
<pre><code class="language-sh">for (( ; ; ))
</code></pre>
<h3 id="until-循环"><a class="header" href="#until-循环">until 循环</a></h3>
<p>until 循环执行一系列命令直至条件为 true 时停止。</p>
<p>与 while 循环在处理方式上刚好相反。</p>
<p>until 语法格式：</p>
<pre><code class="language-sh">until condition
do
  command
done
</code></pre>
<p>输出 0-9</p>
<pre><code class="language-sh">a=0

until [ ! $a -lt 10 ]
do
   echo $a
   a=`expr $a + 1`
done
</code></pre>
<h3 id="case-语句"><a class="header" href="#case-语句">case 语句</a></h3>
<ul>
<li><code>;;</code>: 表示 break</li>
<li><code>*</code>: 如果没有匹配就会走 <code>*</code></li>
</ul>
<pre><code class="language-sh">aNum=1
case $aNum in
    1|2)  echo '你选择了 1'
    ;;
    2)  echo '你选择了 2'
    ;;
    3)  echo '你选择了 3'
    ;;
    4)  echo '你选择了 4'
    ;;
    *)  echo '你没有输入 1 到 4 之间的数字'
    ;;
esac
</code></pre>
<h2 id="函数"><a class="header" href="#函数">函数</a></h2>
<p>bash 的函数类似于进程</p>
<p>参数传递直接跟在函数名之后，参数获取使用 <code>$</code> 获取</p>
<pre><code class="language-sh">funWithParam(){
    echo &quot;第一个参数为 $1 !&quot;
    echo &quot;第二个参数为 $2 !&quot;
    echo &quot;第十个参数为 $10 !&quot;
    echo &quot;第十个参数为 ${10} !&quot;
    echo &quot;第十一个参数为 ${11} !&quot;
    echo &quot;参数总数有 $# 个!&quot;
    echo &quot;作为一个字符串输出所有参数 $* !&quot;
}
funWithParam 1 2 3 4 5 6 7 8 9 34 73
</code></pre>
<ul>
<li>
<p>返回值可选 return，如果不加 return，会以最后一条命令的返回值作为返回值。</p>
</li>
<li>
<p>命令的返回值仅仅表示是否出错，返回值为 0 就是成功，其他值为出错</p>
<blockquote>
<p>要注意的是，和 C 语言不同，shell 语言中 0 代表 true，0 以外的值代表 false。</p>
</blockquote>
</li>
<li>
<p>必须使用 <code>$?</code> 拿到真正的返回值</p>
</li>
</ul>
<pre><code class="language-sh">function demoFun2(){
 echo &quot;这是我的第二个 shell 函数!&quot;
 expr 1 + 1
}

demoFun2
echo $?
</code></pre>
<h2 id="重定向"><a class="header" href="#重定向">重定向</a></h2>
<ul>
<li>
<p>将 stdout 重定向到 file：<code>command &gt; file</code></p>
</li>
<li>
<p>将 stdin 重定向到 file：<code>command &lt; file</code></p>
</li>
<li>
<p>stderr 重定向到 file： <code>command 2&gt;file</code></p>
<blockquote>
<p>注意：这里的 2 和 &gt; 之间不可以有空格，2&gt; 是一体的时候才表示错误输出。</p>
</blockquote>
</li>
<li>
<p>stderr <strong>追加</strong>到 file 文件末尾：<code>command 2&gt;&gt;file</code></p>
</li>
<li>
<p>将 stdout 和 stderr 合并后重定向到 file: <code>command &gt; file 2&gt;&amp;1</code> 或 <code>command &gt;&gt; file 2&gt;&amp;1</code></p>
</li>
<li>
<p>对 stdin 和 stdout 都重定向：<code>command &lt; file1 &gt;file2</code></p>
<p>command 命令将 stdin 重定向到 file1，将 stdout 重定向到 file2。</p>
</li>
</ul>
<p>执行某个命令，但不在屏幕上显示输出结果，那么可以将输出重定向到 <em>/dev/null</em>：</p>
<pre><code class="language-sh">command &gt; /dev/null
</code></pre>
<p>/dev/null 是一个特殊的文件，写入到它的内容都会被丢弃。如果尝试从该文件读取内容，那么什么也读不到。</p>
<p>将命令的输出重定向到它，会起到&quot;禁止输出&quot;的效果。如果希望屏蔽 stdout 和 stderr，可以这样写：</p>
<pre><code class="language-sh">command &gt; /dev/null 2&gt;&amp;1
</code></pre>
<h2 id="import"><a class="header" href="#import">import</a></h2>
<p>Shell 也可以包含外部脚本</p>
<pre><code class="language-sh">#使用 . 号来引用test1.sh 文件
. ./test1.sh

# 或者使用以下包含文件代码
# source ./test1.sh
</code></pre>
<h2 id="其他"><a class="header" href="#其他">其他</a></h2>
<h3 id="echo"><a class="header" href="#echo">echo</a></h3>
<ul>
<li>
<p>执行命令（反引号）</p>
<pre><code class="language-sh">echo `date`
</code></pre>
</li>
<li>
<p>结果重定向</p>
<pre><code class="language-sh">echo &quot;It is a test&quot; &gt; myfile
</code></pre>
</li>
<li>
<p>原样输出字符串，不进行转义或取变量 (用单引号)</p>
<pre><code class="language-sh">echo '$name\&quot;'
</code></pre>
</li>
<li>
<p><code>-e</code> 开启转义</p>
<pre><code class="language-sh">echo -e &quot;OK! \n&quot; # -e 开启转义 \n 换行

echo -e &quot;OK! \c&quot; # -e 开启转义 \c 不换行
</code></pre>
</li>
</ul>
<h3 id="test"><a class="header" href="#test">test</a></h3>
<pre><code class="language-sh">if [ $a == $b ]

if test $a == $b
</code></pre>
<h3 id="注释"><a class="header" href="#注释">注释</a></h3>
<p><code>SomeThing</code> 可以是任何东西</p>
<pre><code class="language-sh">:&lt;&lt;SomeThing
注释内容...
注释内容...
注释内容...
SomeThing
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                                                    <a rel="prev" href="../../docs/magic/haskell.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        
                                                    <a rel="next" href="../../docs/magic/memory_ordering.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                                    <a rel="prev" href="../../docs/magic/haskell.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                
                                    <a rel="next" href="../../docs/magic/memory_ordering.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                            </nav>

        </div>

        
        
        
                <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        
        
                <script src="../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../searcher.js" type="text/javascript" charset="utf-8"></script>
        
        <script src="../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        
        
    </body>
</html>
