<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-magic/software_arch">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">软件架构 | Trdthg&#x27;s blog</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://trdthg.github.io//docs/magic/software_arch"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="软件架构 | Trdthg&#x27;s blog"><meta data-rh="true" name="description" content="六边形架构"><meta data-rh="true" property="og:description" content="六边形架构"><link data-rh="true" rel="icon" href="/img/logo_png.png"><link data-rh="true" rel="canonical" href="https://trdthg.github.io//docs/magic/software_arch"><link data-rh="true" rel="alternate" href="https://trdthg.github.io//docs/magic/software_arch" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://trdthg.github.io//docs/magic/software_arch" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Trdthg&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Trdthg&#39;s blog Atom Feed">

<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-4TM86KZ83J"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-4TM86KZ83J",{anonymize_ip:!0})</script><link rel="stylesheet" href="/assets/css/styles.6b28552f.css">
<link rel="preload" href="/assets/js/runtime~main.31a712e5.js" as="script">
<link rel="preload" href="/assets/js/main.57a661de.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a href="#" class="skipToContent_fXgn">跳到主要内容</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo_png.png" alt="Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo_png.png" alt="Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Trdthg</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">文档</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/trdthg" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/-拓展">🔮 拓展</a><button aria-label="打开/收起侧边栏菜单「🔮 拓展」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/async">协程与异步</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/bash">Bash</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/cicd">CI/CD</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/fd">文件系统</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/go">Go 语言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/hadoop">大数据</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/haskell">Haskell 语言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/linuxIO">IO 多路复用</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/magic/memory_ordering">原子操作与内存顺序</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/magic/software_arch">软件架构</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="true" href="/docs/category/-rust-语言">🦀 Rust 语言</a><button aria-label="打开/收起侧边栏菜单「🦀 Rust 语言」" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item green"><a class="menu__link" tabindex="0" href="/docs/rust">Rust 语言</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/lists">Too-Many-Lists</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/mini_tokio">异步运行时</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/net-piercer">内网穿透工具</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/print_into_detail">Rust print! 宏</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/rs_channel">Channel 源码剖析</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/rust_quiz">Rust Quiz</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/rust/wasm">Wasm 实现生命游戏</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/-学习笔记">📚 学习笔记</a><button aria-label="打开/收起侧边栏菜单「📚 学习笔记」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/-资料库">📦 资料库</a><button aria-label="打开/收起侧边栏菜单「📦 资料库」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/-io-club">⚽ IO Club</a><button aria-label="打开/收起侧边栏菜单「⚽ IO Club」" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">文档页</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/log">日志</a></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/-拓展"><span itemprop="name">🔮 拓展</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">软件架构</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><h1>软件架构</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="六边形架构">六边形架构<a class="hash-link" href="#六边形架构" title="标题的直接链接">​</a></h2><p>六边形架构，是一种软件设计模式。依照这种架构创建的程序，能够在没有 UI
或数据库的情况下正常工作。所以即使没有数据库你依然可以进行开发和运行自动化测试，而且无需其他用户参与。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="端口与适配器">端口与适配器<a class="hash-link" href="#端口与适配器" title="标题的直接链接">​</a></h3><p>六边形架构也叫做端口与适配器架构。</p><p><img loading="lazy" src="https://alistair.cockburn.us/wp-content/uploads/2018/02/Hexagonal-architecture-complex-example.gif" class="img_ev3q"></p><p>什么是端口？</p><p>端口指的是六边形的边，属于应用程序的内部，是我们应用程序的入口和出口。它定义了一个接口，表示设备如何使用我们的用例。在 Rust 里就是由一个
Trait，以及一些 DTO 组成</p><p>什么是适配器？</p><p>适配器围绕着端口编写，能够将输入转化为符合端口的类型，并把输入转化为用用程序内部的方法调用。换句话说就是 <code>controller</code> 或者是命令行一条命令处理器。</p><p>当任何外部设备 (比如：WEB，APP，终端，测试...)
想要访问输入端口时，首先这个输入会被该设备对应的输入适配器，转化为符合要求的可用的方法调用，或者是消息，然后再传递给我们的应用程序。</p><p>当我们的应用程序需要向外发送数据时，首先它会把数据通过输出端口传递给输出适配器，然后再传递给输出对象 (比如：数据库，mock，API，邮件，消息队列...)</p><p>因此我们的应用程序外部是完全隔离的。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="应用程序核心">应用程序核心<a class="hash-link" href="#应用程序核心" title="标题的直接链接">​</a></h3><p>使用六边形架构之后，我们应用程序的核心部分通常被称作域，域中有三个核概念：</p><ul><li>实体 (Entities)：只是简单的定义了对象。</li><li>交互器 (Interactors)：实现复杂的业务逻辑，在本文里我们会将其称为用例 Usecase。</li><li>存储库 (Repositories)：只定义了操作实体的方法。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="优点">优点<a class="hash-link" href="#优点" title="标题的直接链接">​</a></h3><p>在传统的分层架构中，只能从上往下调用。</p><p>而现在我们把接口保留在域中，域不再依赖外部的外部实现。保证了外部设备是可替换的。当业务逻辑需要用到数据存储时，直接调用抽象接口即可。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="参考">参考<a class="hash-link" href="#参考" title="标题的直接链接">​</a></h3><ul><li><a href="https://alexis-lozano.com/hexagonal-architecture-in-rust-1/" target="_blank" rel="noopener noreferrer">Hexagonal architecture in Rust</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="干净架构">干净架构<a class="hash-link" href="#干净架构" title="标题的直接链接">​</a></h2><p><em>The Clean Architecture</em></p><ul><li><a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html" target="_blank" rel="noopener noreferrer">Uncle Bob 原文</a>
文章不太长，</li><li>很好的翻译 + 总结</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="参考-1">参考<a class="hash-link" href="#参考-1" title="标题的直接链接">​</a></h3><p><a href="https://blog.jaggerwang.net/clean-architecture-in-practice/" target="_blank" rel="noopener noreferrer">干净架构最佳实践</a>
<img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202061150405.png" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="分层架构">分层架构<a class="hash-link" href="#分层架构" title="标题的直接链接">​</a></h3><p>起始和上面的差不多，思路都一样，三层架构基本对应</p><p><img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202061222034.png" class="img_ev3q"></p><ul><li>User Interface 层：
系统对外暴露的接口层 (API) 层。主要功能是接收外部的调用，调用底层的服务，然后将底层服务返回的数据返回给调用者。这一层只包含对外的 DTO 对象的声明，接口声明，DTO 对象转换，日志打印等。不能包含因为逻辑。</li><li>Application 层：对应到系统用例层。它描述了整个系统的全部功能，它是对底层领域层对象的组织和编排，通过对领域层对象的编排，实现了用例。Application 层不实现业务逻辑，它只对底层的领域对象进行编排以实现用例。一般在这一层里使用仓储对数据进行读取和保存。事务处理一般也在这一层。这一层主要包括 Service，用来调用 Domain 层的对象完成一个业务。访问第三方的远程调用一般也是在这一层。</li><li>Domain 层：核心业务逻辑层。包含实体、值对象和领域服务等领域对象等。实现所有的业务逻辑。业务逻辑就是存在于问题域即业务领域中的实体、概念、规则和策略等，与具体的实现技术无关，主要包含：1）业务实体（领域对象）。2）业务规则：例如借记卡取款数额不得超过账户余额等等。3) 业务策略：
例如机票预订的超订策略等。4) 完整性约束：
例如账户的账号不得为空。5）业务流程：比如，”下单“是一个业务流程，它包括“用户登录 - 选择商品 - 结算 - 下订单 - 付款”这一系列的动作。
Infrastructure 层：负责所有的对外的交互。比如数据库访问层实现，RPC 接口，MQ 等。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="目录结构">目录结构<a class="hash-link" href="#目录结构" title="标题的直接链接">​</a></h3><p>下面是一个实例目录 (较上面的结构有修改)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── adapter # 适配层</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── api # API 交互接口，将用例适配为 Rest API                    # controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── dao # 数据库访问，实现 usecase/port/dao 下的接口             # dao_impl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── usecase # 第三方服务，实现 usecase/port/service 下的接口     # usecase_impl</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── cli # 命令行交互接口，将用例适配为命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── gui # 图形交互接口，将用例适配为图形界面操作</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── entity # 实体层</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── user # 用户实体                                           # model/do</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── usecase # 用例层</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── ...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── UserUsecases.java # 用户模块相关用例                       # usecase | dao</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── exception # 用例层异常</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── port # 用例层依赖的外部服务接口定义</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>或者抽出一个 domain 代替 entity 和 usecase</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── user # 包含 controller，实现了 dao 和 usecase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   ├── usecase</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   ├── dao # 可替换，例如提供 mysql，postgra 等不同实现</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   │   └── handler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── article</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── domain</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── user # 包含了 model | usecase | dao</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── article</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="参考-2">参考<a class="hash-link" href="#参考-2" title="标题的直接链接">​</a></h3><ul><li><a href="https://blog.jaggerwang.net/clean-architecture-in-practice/" target="_blank" rel="noopener noreferrer">干净架构最佳实践</a></li><li><a href="https://github.com/bxcodec/go-clean-arch" target="_blank" rel="noopener noreferrer">go-clean-arch</a></li><li><a href="https://lailin.xyz/post/go-training-week4-project-layout.html" target="_blank" rel="noopener noreferrer">Go 工程化 (二) 项目目录结构</a></li><li><a href="https://go-kratos.dev/blog/go-project-layout/" target="_blank" rel="noopener noreferrer">Go 工程化 - Project Layout 最佳实践</a></li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="关于-dodtobo-等对象的关系图解">关于 DO，DTO，BO 等对象的关系图解<a class="hash-link" href="#关于-dodtobo-等对象的关系图解" title="标题的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="概念">概念<a class="hash-link" href="#概念" title="标题的直接链接">​</a></h3><p>POJO（Plain Ordinary Java Object）：在本规约中，POJO 专指只有 setter/getter/toString 的简单类，包括
DO/DTO/BO/VO 等。</p><blockquote><p>【参考】分层领域模型规约：—《阿里巴巴 Java 开发规约》</p></blockquote><ul><li>DO（Data Object）：与数据库表结构一一对应，通过 DAO 层向上传输数据源对象。</li><li>DTO（Data Transfer Object）：数据传输对象，Service 或 Manager 向外传输的对象。</li><li>BO（Business Object）：业务对象。可以由 Service 层输出的封装业务逻辑的对象。</li><li>Query：数据查询对象，各层接收上层的查询请求。额外规定：【强制】超过 2 个参数的查询封装，禁止使用 Map 类来传输。</li><li>VO（View Object）：显示层对象，通常是 Web 向模板渲染引擎层传输的对象。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="说人话就是">说人话就是<a class="hash-link" href="#说人话就是" title="标题的直接链接">​</a></h3><ul><li><p>DAO：封装对数据库的访问，常规的增删改查（CRUD 操作）都通过 DAO 来实现。</p></li><li><p>PO/DO: 跟数据库表是一一对应的，一个 PO/DO 数据是表的一条记录。PO / DO 只是数据的对象，不包含任何的操作。举个例子，学生表是
StudentDO，对学生表的增删改查等操作就是 StudentDAO。</p></li><li><p>DTO：</p><ul><li>在分布式系统中，系统之间可以通过 DTO
进行数据传输；<a href="https://www.google.com/search?q=&amp;oq=DDD+%E5%92%8C+%E5%B9%B2%E5%87%80%E6%9E%B6%E6%9E%84%E7%9A%84%E5%8C%BA%E5%88%AB&amp;aqs=chrome..69i57.9554j0j1&amp;sourceid=chrome&amp;ie=UTF-8" target="_blank" rel="noopener noreferrer">https://www.google.com/search?q=&amp;oq=DDD+%E5%92%8C+%E5%B9%B2%E5%87%80%E6%9E%B6%E6%9E%84%E7%9A%84%E5%8C%BA%E5%88%AB&amp;aqs=chrome..69i57.9554j0j1&amp;sourceid=chrome&amp;ie=UTF-8</a></li><li>DTO 也可以在应用内部，核心层和应用层之间传递数据，DTO 只是简单的数据传输，没有业务逻辑的处理；</li><li>有的场景，比如数据库表有 10 个字段，id(唯一 id)、version(版本号)，gmt_create(记录创建时间) 这些字段不需要对外提供，所以
DTO 可以只取有含义的业务字段，DO 是和数据库记录的一一映射，但是 DTO 只需要按照业务需要定义需要的字段。</li></ul></li><li><p>BO: 包含 PO/DO 和 DAO，有点类似于 domain(entity, usecase) 的概念，BO
主要作用是把业务逻辑封装为一个对象。这个对象可以包括一个或多个其它的对象，还能够完成 DO - DTO 之间的转换</p></li><li><p>VO: 对应页面显示（web 页面/移动端 H5/Native 视图）的数据对象。举个例子，DTO 中时间 Date 格式，或者是
yyyyMMddHHmmss 的字符串，但是 VO 需要的是前端展示的格式，需要转成”yyyy 年 MM 月 dd 月&quot;；</p></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="图解">图解<a class="hash-link" href="#图解" title="标题的直接链接">​</a></h3><p><img loading="lazy" src="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202061126981.png" class="img_ev3q"></p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文档分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/magic/memory_ordering"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">原子操作与内存顺序</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/-rust-语言"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">🦀 Rust 语言</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#六边形架构" class="table-of-contents__link toc-highlight">六边形架构</a><ul><li><a href="#端口与适配器" class="table-of-contents__link toc-highlight">端口与适配器</a></li><li><a href="#应用程序核心" class="table-of-contents__link toc-highlight">应用程序核心</a></li><li><a href="#优点" class="table-of-contents__link toc-highlight">优点</a></li><li><a href="#参考" class="table-of-contents__link toc-highlight">参考</a></li></ul></li><li><a href="#干净架构" class="table-of-contents__link toc-highlight">干净架构</a><ul><li><a href="#参考-1" class="table-of-contents__link toc-highlight">参考</a></li><li><a href="#分层架构" class="table-of-contents__link toc-highlight">分层架构</a></li><li><a href="#目录结构" class="table-of-contents__link toc-highlight">目录结构</a></li><li><a href="#参考-2" class="table-of-contents__link toc-highlight">参考</a></li></ul></li><li><a href="#关于-dodtobo-等对象的关系图解" class="table-of-contents__link toc-highlight">关于 DO，DTO，BO 等对象的关系图解</a><ul><li><a href="#概念" class="table-of-contents__link toc-highlight">概念</a></li><li><a href="#说人话就是" class="table-of-contents__link toc-highlight">说人话就是</a></li><li><a href="#图解" class="table-of-contents__link toc-highlight">图解</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.31a712e5.js"></script>
<script src="/assets/js/main.57a661de.js"></script>
</body>
</html>