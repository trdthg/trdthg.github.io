<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202022217241.jpg"><title>OAuth 2.0 Simplified | Trdthg's blog</title><meta name="description" content="我的个人网站">
    <link rel="modulepreload" href="/assets/app.9ad42599.js"><link rel="modulepreload" href="/assets/oauth2.html.a6e6f8dd.js"><link rel="modulepreload" href="/assets/oauth2.html.27bd0b02.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/assets/style.e8e8fc80.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">Trdthg&#39;s blog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习笔记 📚"><span class="title">学习笔记 📚</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习笔记 📚"><span class="title">学习笔记 📚</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>前端相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/frontend/vdom" class="" aria-label="虚拟DOM"><!--[--><!--]--> 虚拟DOM <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/js_advanced" class="" aria-label="js进阶"><!--[--><!--]--> js进阶 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/list" class="" aria-label="资料"><!--[--><!--]--> 资料 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/vue" class="" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/http" class="" aria-label="HTTP相关"><!--[--><!--]--> HTTP相关 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/flutter" class="" aria-label="Flutter"><!--[--><!--]--> Flutter <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>python相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/other/python" class="" aria-label="总览"><!--[--><!--]--> 总览 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>java相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java/java" class="" aria-label="基础知识"><!--[--><!--]--> 基础知识 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/sourceread" class="" aria-label="部分源码"><!--[--><!--]--> 部分源码 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/spring" class="" aria-label="Spring框架"><!--[--><!--]--> Spring框架 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/springboot" class="" aria-label="常用工具"><!--[--><!--]--> 常用工具 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="小项目 💪"><span class="title">小项目 💪</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="小项目 💪"><span class="title">小项目 💪</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/projects/mini_vue" class="" aria-label="mini-vue"><!--[--><!--]--> mini-vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/projects/mini_bundle" class="" aria-label="打包器"><!--[--><!--]--> 打包器 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/projects/mini_tokio" class="" aria-label="异步运行时"><!--[--><!--]--> 异步运行时 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Rust 🦀"><span class="title">Rust 🦀</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Rust 🦀"><span class="title">Rust 🦀</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/rust/rust" class="" aria-label="语言特性"><!--[--><!--]--> 语言特性 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/dioxus" class="" aria-label="dioxus前端"><!--[--><!--]--> dioxus前端 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/wasm" class="" aria-label="Wasm 体验"><!--[--><!--]--> Wasm 体验 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/lists" class="" aria-label="实现链表"><!--[--><!--]--> 实现链表 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="魔法 🔮"><span class="title">魔法 🔮</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="魔法 🔮"><span class="title">魔法 🔮</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/magic/haskell" class="" aria-label="haskell学习笔记"><!--[--><!--]--> haskell学习笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/fd" class="" aria-label="文件描述符"><!--[--><!--]--> 文件描述符 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/linuxIO" class="" aria-label="IO 多路复用"><!--[--><!--]--> IO 多路复用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/memory_ordering" class="" aria-label="原子操作/内存顺序"><!--[--><!--]--> 原子操作/内存顺序 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/software_arch" class="" aria-label="软件架构"><!--[--><!--]--> 软件架构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/cicd" class="" aria-label="CI/CD"><!--[--><!--]--> CI/CD <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="IO Club ⚽"><span class="title">IO Club ⚽</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="IO Club ⚽"><span class="title">IO Club ⚽</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>分享</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ioclub/share_1" class="" aria-label="关于数据库与B+树"><!--[--><!--]--> 关于数据库与B+树 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>授课</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_1" class="" aria-label="后端1"><!--[--><!--]--> 后端1 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_2" class="" aria-label="后端2"><!--[--><!--]--> 后端2 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_3" class="" aria-label="后端3"><!--[--><!--]--> 后端3 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_4" class="" aria-label="后端4"><!--[--><!--]--> 后端4 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他 📦"><span class="title">其他 📦</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他 📦"><span class="title">其他 📦</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/other/hadoop" class="" aria-label="hadoop"><!--[--><!--]--> hadoop <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/script" class="" aria-label="脚本"><!--[--><!--]--> 脚本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/datastructure" class="" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/vim" class="" aria-label="vim"><!--[--><!--]--> vim <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/git" class="" aria-label="git"><!--[--><!--]--> git <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/docker" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/oauth2" class="router-link-active" aria-label="oauth2学习"><!--[--><!--]--> oauth2学习 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/trdthg" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习笔记 📚"><span class="title">学习笔记 📚</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习笔记 📚"><span class="title">学习笔记 📚</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>前端相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/frontend/vdom" class="" aria-label="虚拟DOM"><!--[--><!--]--> 虚拟DOM <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/js_advanced" class="" aria-label="js进阶"><!--[--><!--]--> js进阶 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/list" class="" aria-label="资料"><!--[--><!--]--> 资料 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/vue" class="" aria-label="vue"><!--[--><!--]--> vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/http" class="" aria-label="HTTP相关"><!--[--><!--]--> HTTP相关 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/flutter" class="" aria-label="Flutter"><!--[--><!--]--> Flutter <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>python相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/other/python" class="" aria-label="总览"><!--[--><!--]--> 总览 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>java相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java/java" class="" aria-label="基础知识"><!--[--><!--]--> 基础知识 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/sourceread" class="" aria-label="部分源码"><!--[--><!--]--> 部分源码 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/spring" class="" aria-label="Spring框架"><!--[--><!--]--> Spring框架 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/springboot" class="" aria-label="常用工具"><!--[--><!--]--> 常用工具 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="小项目 💪"><span class="title">小项目 💪</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="小项目 💪"><span class="title">小项目 💪</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/projects/mini_vue" class="" aria-label="mini-vue"><!--[--><!--]--> mini-vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/projects/mini_bundle" class="" aria-label="打包器"><!--[--><!--]--> 打包器 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/projects/mini_tokio" class="" aria-label="异步运行时"><!--[--><!--]--> 异步运行时 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Rust 🦀"><span class="title">Rust 🦀</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Rust 🦀"><span class="title">Rust 🦀</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/rust/rust" class="" aria-label="语言特性"><!--[--><!--]--> 语言特性 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/dioxus" class="" aria-label="dioxus前端"><!--[--><!--]--> dioxus前端 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/wasm" class="" aria-label="Wasm 体验"><!--[--><!--]--> Wasm 体验 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/lists" class="" aria-label="实现链表"><!--[--><!--]--> 实现链表 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="魔法 🔮"><span class="title">魔法 🔮</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="魔法 🔮"><span class="title">魔法 🔮</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/magic/haskell" class="" aria-label="haskell学习笔记"><!--[--><!--]--> haskell学习笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/fd" class="" aria-label="文件描述符"><!--[--><!--]--> 文件描述符 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/linuxIO" class="" aria-label="IO 多路复用"><!--[--><!--]--> IO 多路复用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/memory_ordering" class="" aria-label="原子操作/内存顺序"><!--[--><!--]--> 原子操作/内存顺序 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/software_arch" class="" aria-label="软件架构"><!--[--><!--]--> 软件架构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/cicd" class="" aria-label="CI/CD"><!--[--><!--]--> CI/CD <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="IO Club ⚽"><span class="title">IO Club ⚽</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="IO Club ⚽"><span class="title">IO Club ⚽</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>分享</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ioclub/share_1" class="" aria-label="关于数据库与B+树"><!--[--><!--]--> 关于数据库与B+树 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>授课</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_1" class="" aria-label="后端1"><!--[--><!--]--> 后端1 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_2" class="" aria-label="后端2"><!--[--><!--]--> 后端2 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_3" class="" aria-label="后端3"><!--[--><!--]--> 后端3 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_4" class="" aria-label="后端4"><!--[--><!--]--> 后端4 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="其他 📦"><span class="title">其他 📦</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="其他 📦"><span class="title">其他 📦</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/other/hadoop" class="" aria-label="hadoop"><!--[--><!--]--> hadoop <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/script" class="" aria-label="脚本"><!--[--><!--]--> 脚本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/datastructure" class="" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/vim" class="" aria-label="vim"><!--[--><!--]--> vim <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/git" class="" aria-label="git"><!--[--><!--]--> git <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/docker" class="" aria-label="docker"><!--[--><!--]--> docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/oauth2" class="router-link-active" aria-label="oauth2学习"><!--[--><!--]--> oauth2学习 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/trdthg" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">OAuth 2.0 Simplified <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/other/oauth2.html#_1-getting-ready-开始" class="router-link-active router-link-exact-active sidebar-item" aria-label="1. Getting ready 开始"><!--[--><!--]--> 1. Getting ready 开始 <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/other/oauth2.html#_1-1-creating-an-application-一般需要-sign-up-as-a-developer" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.1 Creating an Application(一般需要 sign up as a developer)"><!--[--><!--]--> 1.1 Creating an Application(一般需要 sign up as a developer) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/other/oauth2.html#_1-2-redirect-urls-and-state" class="router-link-active router-link-exact-active sidebar-item" aria-label="1.2 Redirect URLs and State"><!--[--><!--]--> 1.2 Redirect URLs and State <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/other/oauth2.html#_2-accessing-data-获取数据-github为例" class="router-link-active router-link-exact-active sidebar-item" aria-label="2. Accessing data 获取数据(github为例)"><!--[--><!--]--> 2. Accessing data 获取数据(github为例) <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/other/oauth2.html#_3-signing-in-with-google" class="router-link-active router-link-exact-active sidebar-item" aria-label="3. Signing in with Google"><!--[--><!--]--> 3. Signing in with Google <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/other/oauth2.html#_3-1-如何获取用户信息" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.1 如何获取用户信息"><!--[--><!--]--> 3.1 如何获取用户信息 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/other/oauth2.html#_3-2-下面以google提供的api为例" class="router-link-active router-link-exact-active sidebar-item" aria-label="3.2 下面以Google提供的api为例"><!--[--><!--]--> 3.2 下面以Google提供的api为例 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><li><a aria-current="page" href="/other/oauth2.html#_4-server-side-apps" class="router-link-active router-link-exact-active sidebar-item" aria-label="4 Server-Side Apps"><!--[--><!--]--> 4 Server-Side Apps <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="oauth-2-0-simplified" tabindex="-1"><a class="header-anchor" href="#oauth-2-0-simplified" aria-hidden="true">#</a> OAuth 2.0 Simplified</h1><p><a href="https://www.oauth.com/" target="_blank" rel="noopener noreferrer">www.oauth.com<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="_1-getting-ready-开始" tabindex="-1"><a class="header-anchor" href="#_1-getting-ready-开始" aria-hidden="true">#</a> 1. Getting ready 开始</h2><h3 id="_1-1-creating-an-application-一般需要-sign-up-as-a-developer" tabindex="-1"><a class="header-anchor" href="#_1-1-creating-an-application-一般需要-sign-up-as-a-developer" aria-hidden="true">#</a> 1.1 Creating an Application(一般需要 sign up as a developer)</h3><p>user -&gt; entering basic information such as the name, website, logo, etc. server -&gt; return a <strong>client_id</strong> (and a <strong>client_secret</strong> in some cases)</p><h3 id="_1-2-redirect-urls-and-state" tabindex="-1"><a class="header-anchor" href="#_1-2-redirect-urls-and-state" aria-hidden="true">#</a> 1.2 Redirect URLs and State</h3><ol><li>为了使同一个clientID同时拥有多个状态, Some services may allow you to register multiple redirect URLs 比如:</li></ol><ul><li>Web app and Mobile app</li><li>development service and production service</li></ul><ol start="2"><li>为了保证安全: 必须使用https防止在认证过程中code被拦截</li></ol><ul><li>大多数服务(service)需要路由完全匹配, 这意味着<a href="https://example.com/auth" target="_blank" rel="noopener noreferrer">https://example.com/auth<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 的重定向 URL 将与 <a href="https://example.com/auth?destination=account" target="_blank" rel="noopener noreferrer">https://example.com/auth?destination=account<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 不匹配. 所以最佳做法是不在url里使用query string parameters</li><li>少部分服务需要可以从多种url发起认证，可以选择注册多个重定向url, 或者改变这些请求的重定向url, 但是oauth2提供了一种机制=&gt; 状态参数(State) State的特点</li></ul><ol start="3"><li>State</li></ol><ul><li>可以用来作为加密的salt</li><li>可以是某种随机数据</li><li>对与service来说是不可见的 -&gt; 在初始化认证请求时(initial authorization request)传入的任何State都会在用户授权给app(user authorizes the application)后被返回</li></ul><blockquote><p>state用于额外的安全检查, 当github返回数据时可以确认不是攻击者发出的请求, 比如将攻击者的authorization token发送给github, as well as SCRF attack</p></blockquote><p>比如: 你可以将一个重定向的url经过encode后like JWT, 在用户返回app后解析这个JWT将用户带回合适的位置</p><h2 id="_2-accessing-data-获取数据-github为例" tabindex="-1"><a class="header-anchor" href="#_2-accessing-data-获取数据-github为例" aria-hidden="true">#</a> 2. Accessing data 获取数据(github为例)</h2><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$out_app</span> <span class="token operator">=</span> <span class="token string double-quoted-string">&quot;在github填的homepage&quot;</span>

<span class="token variable">$authorizeURL</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://github.com/login/oauth/authorize&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// This is the endpoint we&#39;ll request an access token from</span>
<span class="token variable">$tokenURL</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://github.com/login/oauth/access_token&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// This is the GitHub base URL for API requests</span>
<span class="token variable">$apiURLBase</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://api.github.com/&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// The URL for this script, used as the redirect URL</span>
<span class="token variable">$baseURL</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://&#39;</span> <span class="token operator">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;SERVER_NAME&#39;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;PHP_SELF&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ol><li>获取登录凭证(access_token)</li></ol><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code>           开始
            <span class="token operator">|</span>
            <span class="token operator">|</span> 从某处发起HttpRequest重定向到<span class="token function">authorizeURL</span><span class="token punctuation">(</span>不一定是our<span class="token operator">-</span>app<span class="token punctuation">)</span>
            <span class="token operator">|</span> 携带
            <span class="token operator">|</span> <span class="token punctuation">{</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;response_type&#39;</span><span class="token operator">=</span> <span class="token string single-quoted-string">&#39;code&#39;</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;client_id&#39;</span> <span class="token operator">=</span> <span class="token variable">$githubClientID</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;redirect_uri&#39;</span> <span class="token operator">=</span> <span class="token variable">$baseURL</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;scope&#39;</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;user public_repo&#39;</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;status&#39;</span><span class="token operator">=</span> <span class="token string single-quoted-string">&#39;random_string(10)&#39;</span>
            <span class="token operator">|</span> <span class="token punctuation">}</span>
            ∨
        github认证界面
            <span class="token operator">|</span>
            <span class="token operator">|</span> 点击确认
            <span class="token operator">|</span> <span class="token keyword">if</span> status_send <span class="token operator">==</span> status_resp<span class="token punctuation">:</span>
            <span class="token operator">|</span>     携带code和status重定向到app界面
            ∨
        our<span class="token operator">-</span><span class="token class-name">app</span>
            <span class="token operator">|</span>
            <span class="token operator">|</span> <span class="token class-name">exchange</span> the authorization code <span class="token keyword">for</span> an access token<span class="token operator">.</span>
            <span class="token operator">|</span> 携带
            <span class="token operator">|</span> <span class="token punctuation">{</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;grant_type&#39;</span> <span class="token operator">=&gt;</span> <span class="token string single-quoted-string">&#39;authorization_code&#39;</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;client_id&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$githubClientID</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;client_secret&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$githubClientSecret</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;redirect_uri&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$baseURL</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string single-quoted-string">&#39;code&#39;</span> <span class="token operator">=&gt;</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;code&#39;</span><span class="token punctuation">]</span>
            <span class="token operator">|</span> <span class="token punctuation">}</span>
            <span class="token operator">|</span> 再次请求tokenURL使用code交换<span class="token class-name">token</span>
            <span class="token operator">|</span> <span class="token punctuation">{</span>
            <span class="token operator">|</span>     <span class="token string double-quoted-string">&quot;access_token&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;e2f8c8e136c73b1e909bb1021b3b4c29&quot;</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string double-quoted-string">&quot;token_type&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;Bearer&quot;</span><span class="token punctuation">,</span>
            <span class="token operator">|</span>     <span class="token string double-quoted-string">&quot;scope&quot;</span><span class="token punctuation">:</span> <span class="token string double-quoted-string">&quot;public_repo,user&quot;</span>
            <span class="token operator">|</span> <span class="token punctuation">}</span>
            <span class="token operator">|</span> 重定向到<span class="token function">homepage</span><span class="token punctuation">(</span>baseURL<span class="token punctuation">)</span>，用户成功登录
            ∨
        <span class="token class-name">appHomePage</span>
            <span class="token operator">|</span>
            <span class="token operator">|</span> 把access_token存入session<span class="token punctuation">,</span> 下次进入app时就能通过access_token进入登录成功后的界面
            ∨
           End
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><ol start="2"><li>利用access_token获取数据 直接在header里添加access_token请求apiURLBase就完事了</li></ol><h2 id="_3-signing-in-with-google" tabindex="-1"><a class="header-anchor" href="#_3-signing-in-with-google" aria-hidden="true">#</a> 3. Signing in with Google</h2><h3 id="_3-1-如何获取用户信息" tabindex="-1"><a class="header-anchor" href="#_3-1-如何获取用户信息" aria-hidden="true">#</a> 3.1 如何获取用户信息</h3><p>两个关键词</p><ul><li>authorization 鉴权: trying to gain access or modify something that belongs to the user.</li><li>authentication 校验: just verifying who the user is OAuth is designed as a authorization protocol(授权协议), 所以access_token不能被用来判断用户是谁 有以下几种不同services为app提供的方法可以判断用户是谁</li></ul><ol><li>a simple way: 让api顺便返回一些profile_info(用户信息), 不包含在OAuth标准里</li><li>a advanced approach: use OpenID Connect(an OAuth2.0 extension) <ul><li>利用id_token</li><li>使用access_token 如何选择获取user_info的方法 A: For performance-sensitive applications where you might be reading ID tokens on every request or using them to maintain a session, you should definitely validate the ID token locally rather than making a network request.<a href="https://developers.google.com/identity/protocols/OpenIDConnect#validatinganidtoken" target="_blank" rel="noopener noreferrer">https://developers.google.com/identity/protocols/OpenIDConnect#validatinganidtoken<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> B: just for find the user’s name and email after they sign in, then extracting the data from the ID token and storing it in your application session</li></ul></li></ol><h3 id="_3-2-下面以google提供的api为例" tabindex="-1"><a class="header-anchor" href="#_3-2-下面以google提供的api为例" aria-hidden="true">#</a> 3.2 下面以Google提供的api为例</h3><div class="language-php ext-php line-numbers-mode"><pre class="language-php"><code><span class="token variable">$authorizeURL</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://accounts.google.com/o/oauth2/v2/auth&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// This is Google&#39;s OpenID Connect token endpoint</span>
<span class="token variable">$tokenURL</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://www.googleapis.com/oauth2/v4/token&#39;</span><span class="token punctuation">;</span>
<span class="token comment">// The URL for this script, used as the redirect URL</span>
<span class="token variable">$baseURL</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;https://&#39;</span> <span class="token operator">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;SERVER_NAME&#39;</span><span class="token punctuation">]</span> <span class="token operator">.</span> <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;PHP_SELF&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>与github的不同</p><ol><li>Google的认证界面只能选择使用那个帐号(用户), 没有点击授权的按钮</li><li>请求access_token的返回值</li></ol><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;access_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ya29.Glins-oLtuljNVfthQU2bpJVJPTu&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;token_type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bearer&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;expires_in&quot;</span><span class="token operator">:</span> <span class="token number">3600</span><span class="token punctuation">,</span>
  <span class="token property">&quot;id_token&quot;</span><span class="token operator">:</span> &quot;eyJhbGciOiJSUzI1NiIsImtpZCI6ImFmZmM2MjkwN
  2E0NDYxODJhZGMxZmE0ZTgxZmRiYTYzMTBkY2U2M2YifQ.eyJhenAi
  OiIyNzIxOTYwNjkxNzMtZm81ZWI0MXQzbmR1cTZ1ZXRkc2pkdWdzZX
  V0ZnBtc3QuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJhdWQi
  OiIyNzIxOTYwNjkxNzMtZm81ZWI0MXQzbmR1cTZ1ZXRkc2pkdWdzZX
  V0ZnBtc3QuYXBwcy5nb29nbGV1c2VyY29udGVudC5jb20iLCJzdWIi
  OiIxMTc4NDc5MTI4NzU5MTM5MDU0OTMiLCJlbWFpbCI6ImFhcm9uLn
  BhcmVja2lAZ21haWwuY29tIiwiZW1haWxfdmVyaWZpZWQiOnRydWUs
  ImF0X2hhc2giOiJpRVljNDBUR0luUkhoVEJidWRncEpRIiwiZXhwIj
  oxNTI0NTk5MDU2LCJpc3MiOiJodHRwczovL2FjY291bnRzLmdvb2ds
  ZS5jb20iLCJpYXQiOjE1MjQ1OTU0NTZ9.ho2czp_1JWsglJ9jN8gCg
  WfxDi2gY4X5-QcT56RUGkgh5BJaaWdlrRhhN_eNuJyN3HRPhvVA_KJ
  Vy1tMltTVd2OQ6VkxgBNfBsThG_zLPZriw7a1lANblarwxLZID4fXD
  YG-O8U-gw4xb-NIsOzx6xsxRBdfKKniavuEg56Sd3eKYyqrMA0DWnI
  agqLiKE6kpZkaGImIpLcIxJPF0-yeJTMt_p1NoJF7uguHHLYr6752h
  qppnBpMjFL2YMDVeg3jl1y5DeSKNPh6cZ8H2p4Xb2UIrJguGbQHVIJ
  vtm_AspRjrmaTUQKrzXDRCfDROSUU-h7XKIWRrEd2-W9UkV5oCg&quot;
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>下面是前两端的解码信息段</p><div class="language-json ext-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;alg&quot;</span><span class="token operator">:</span> <span class="token string">&quot;RS256&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;kid&quot;</span><span class="token operator">:</span> <span class="token string">&quot;affc62907a446182adc1fa4e81fdba6310dce63f&quot;</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;azp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;272196069173-fo5eb41t3nduq6uetdsjdugseutfpmst.apps.googleusercontent.com&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;aud&quot;</span><span class="token operator">:</span> <span class="token string">&quot;272196069173-fo5eb41t3nduq6uetdsjdugseutfpmst.apps.googleusercontent.com&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;sub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;117847912875913905493&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aaron.parecki@gmail.com&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;email_verified&quot;</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token property">&quot;at_hash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;iEYc40TGInRHhTBbudgpJQ&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;exp&quot;</span><span class="token operator">:</span> <span class="token number">1524599056</span><span class="token punctuation">,</span>
  <span class="token property">&quot;iss&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://accounts.google.com&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;iat&quot;</span><span class="token operator">:</span> <span class="token number">1524595456</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>access_token should be tracted as opaque(不透明), 因为里面没有重要信息 一般来说, 提取id_token中的信息之前进行校验是很重要的, 防止这个token是有其他人下发的, 在上面的示例中, 我们使用了https以确保token确实来自Google sub是用户的标识符，与帐号绑定，即使更换邮箱也不会变</p><blockquote><p>下面是一些解释 azp: 授权演示者的client_id 。仅当请求ID令牌的一方与ID令牌的受众不同时才需要此声明。 aud: 此ID令牌的目标受众。它必须是您应用程序的OAuth 2.0客户端ID之一。</p></blockquote><h2 id="_4-server-side-apps" tabindex="-1"><a class="header-anchor" href="#_4-server-side-apps" aria-hidden="true">#</a> 4 Server-Side Apps</h2><ol><li>请求code时的queryString</li></ol><ul><li>response_type: 想要获取的返回值类型</li><li>client_id: app的identifier</li><li>redirect_url(optional): 授权完成后的跳转页面(需要在注册app时设置)</li><li>scope(optional): Include one or more scope values (space-separated) to request additional levels of access. The values will depend on the particular service.(用空格分隔)</li><li>status: 会被服务端完整返回，can be used to letyour app persist data between the user being directed to the authorization server and back again，</li></ul><blockquote><p>比如using it as session_key to indicate what action the app to perform after authorization is complete(比如重定向的链接) 如果每次request的status都是随机生成的，status也能用来保护from CSRF</p></blockquote><ol start="2"><li>交换access_token的queryString</li></ol><ul><li>grant_type(required): 必须要设置为authorization_code</li><li>code(required): will be in the query string parameter “code” in this request.</li><li>redirect_uri (possibly required)</li><li>Client Authentication (required): 一般是client_id和client_secret</li></ul><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/trdthg/edit/main/other/oauth2.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: trdthg@outlook.com">trdthg</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.9ad42599.js" defer></script>
  </body>
</html>
