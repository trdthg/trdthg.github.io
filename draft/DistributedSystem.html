<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <link rel="icon" href="https://trdthg-img-for-md-1306147581.cos.ap-beijing.myqcloud.com/img/202202022217241.jpg"><title>分布式系统 | Trdthg's blog</title><meta name="description" content="Welcome to Trdthg's blog">
    <link rel="modulepreload" href="/assets/app.87562571.js"><link rel="modulepreload" href="/assets/DistributedSystem.html.daeca2b5.js"><link rel="modulepreload" href="/assets/DistributedSystem.html.4b28c050.js"><link rel="modulepreload" href="/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/assets/style.e8e8fc80.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name can-hide">Trdthg&#39;s blog</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Rust 🦀"><span class="title">Rust 🦀</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Rust 🦀"><span class="title">Rust 🦀</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/rust/rust" class="" aria-label="语言特性"><!--[--><!--]--> 语言特性 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/print_into_detail" class="" aria-label="print 宏详解"><!--[--><!--]--> print 宏详解 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/rs_channel" class="" aria-label="channel 源码剖析 doing"><!--[--><!--]--> channel 源码剖析 doing <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/wasm" class="" aria-label="Wasm"><!--[--><!--]--> Wasm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/lists" class="" aria-label="Rust 链表"><!--[--><!--]--> Rust 链表 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/go" class="" aria-label="Go 学习笔记"><!--[--><!--]--> Go 学习笔记 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="魔法 🔮"><span class="title">魔法 🔮</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="魔法 🔮"><span class="title">魔法 🔮</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/magic/haskell" class="" aria-label="Haskell 学习笔记"><!--[--><!--]--> Haskell 学习笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/fd" class="" aria-label="文件描述符"><!--[--><!--]--> 文件描述符 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/linuxIO" class="" aria-label="IO 多路复用"><!--[--><!--]--> IO 多路复用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/memory_ordering" class="" aria-label="原子操作/内存顺序"><!--[--><!--]--> 原子操作/内存顺序 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/async" class="" aria-label="协程异步思考"><!--[--><!--]--> 协程异步思考 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/software_arch" class="" aria-label="软件架构"><!--[--><!--]--> 软件架构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/cicd" class="" aria-label="CI/CD"><!--[--><!--]--> CI/CD <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="杂文 🍱"><span class="title">杂文 🍱</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="杂文 🍱"><span class="title">杂文 🍱</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/articles/menu" class="" aria-label="优质文章资源"><!--[--><!--]--> 优质文章资源 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/articles/i3wm" class="" aria-label="折腾 i3wm"><!--[--><!--]--> 折腾 i3wm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/articles/tail_latency" class="" aria-label="(译) 尾部延迟"><!--[--><!--]--> (译) 尾部延迟 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/articles/search_engine" class="" aria-label="(译) 查询引擎"><!--[--><!--]--> (译) 查询引擎 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习笔记 📚"><span class="title">学习笔记 📚</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习笔记 📚"><span class="title">学习笔记 📚</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>前端相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/frontend/vdom" class="" aria-label="虚拟 DOM"><!--[--><!--]--> 虚拟 DOM <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/js_advanced" class="" aria-label="Js 进阶"><!--[--><!--]--> Js 进阶 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/list" class="" aria-label="资料"><!--[--><!--]--> 资料 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/vue" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/http" class="" aria-label="HTTP 相关"><!--[--><!--]--> HTTP 相关 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/flutter" class="" aria-label="Flutter"><!--[--><!--]--> Flutter <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Python 相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/other/python" class="" aria-label="总览"><!--[--><!--]--> 总览 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Java 相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java/java" class="" aria-label="基础知识"><!--[--><!--]--> 基础知识 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/sourceread" class="" aria-label="部分源码"><!--[--><!--]--> 部分源码 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/spring" class="" aria-label="Spring 框架"><!--[--><!--]--> Spring 框架 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/springboot" class="" aria-label="常用工具"><!--[--><!--]--> 常用工具 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="小玩具 🎮"><span class="title">小玩具 🎮</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="小玩具 🎮"><span class="title">小玩具 🎮</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/projects/mini_vue" class="" aria-label="Mini-Vue"><!--[--><!--]--> Mini-Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/projects/mini_bundle" class="" aria-label="打包器"><!--[--><!--]--> 打包器 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/projects/mini_tokio" class="" aria-label="异步运行时"><!--[--><!--]--> 异步运行时 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="IO Club ⚽"><span class="title">IO Club ⚽</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="IO Club ⚽"><span class="title">IO Club ⚽</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>分享</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ioclub/share_1" class="" aria-label="关于数据库与 B+ 树"><!--[--><!--]--> 关于数据库与 B+ 树 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>授课</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_1" class="" aria-label="后端 1"><!--[--><!--]--> 后端 1 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_2" class="" aria-label="后端 2"><!--[--><!--]--> 后端 2 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_3" class="" aria-label="后端 3"><!--[--><!--]--> 后端 3 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_4" class="" aria-label="后端 4"><!--[--><!--]--> 后端 4 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="资料库 📦"><span class="title">资料库 📦</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="资料库 📦"><span class="title">资料库 📦</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/other/hadoop" class="" aria-label="大数据"><!--[--><!--]--> 大数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/script" class="" aria-label="脚本"><!--[--><!--]--> 脚本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/datastructure" class="" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/vim" class="" aria-label="Vim"><!--[--><!--]--> Vim <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/git" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/docker" class="" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/analyze" class="" aria-label="性能监测工具"><!--[--><!--]--> 性能监测工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/oci" class="" aria-label="OCI 规范"><!--[--><!--]--> OCI 规范 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/oauth2" class="" aria-label="OAuth2.0"><!--[--><!--]--> OAuth2.0 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/trdthg" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="切换夜间"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="Rust 🦀"><span class="title">Rust 🦀</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="Rust 🦀"><span class="title">Rust 🦀</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/rust/rust" class="" aria-label="语言特性"><!--[--><!--]--> 语言特性 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/print_into_detail" class="" aria-label="print 宏详解"><!--[--><!--]--> print 宏详解 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/rs_channel" class="" aria-label="channel 源码剖析 doing"><!--[--><!--]--> channel 源码剖析 doing <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/wasm" class="" aria-label="Wasm"><!--[--><!--]--> Wasm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/lists" class="" aria-label="Rust 链表"><!--[--><!--]--> Rust 链表 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/rust/go" class="" aria-label="Go 学习笔记"><!--[--><!--]--> Go 学习笔记 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="魔法 🔮"><span class="title">魔法 🔮</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="魔法 🔮"><span class="title">魔法 🔮</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/magic/haskell" class="" aria-label="Haskell 学习笔记"><!--[--><!--]--> Haskell 学习笔记 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/fd" class="" aria-label="文件描述符"><!--[--><!--]--> 文件描述符 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/linuxIO" class="" aria-label="IO 多路复用"><!--[--><!--]--> IO 多路复用 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/memory_ordering" class="" aria-label="原子操作/内存顺序"><!--[--><!--]--> 原子操作/内存顺序 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/async" class="" aria-label="协程异步思考"><!--[--><!--]--> 协程异步思考 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/software_arch" class="" aria-label="软件架构"><!--[--><!--]--> 软件架构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/magic/cicd" class="" aria-label="CI/CD"><!--[--><!--]--> CI/CD <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="杂文 🍱"><span class="title">杂文 🍱</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="杂文 🍱"><span class="title">杂文 🍱</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/articles/menu" class="" aria-label="优质文章资源"><!--[--><!--]--> 优质文章资源 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/articles/i3wm" class="" aria-label="折腾 i3wm"><!--[--><!--]--> 折腾 i3wm <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/articles/tail_latency" class="" aria-label="(译) 尾部延迟"><!--[--><!--]--> (译) 尾部延迟 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/articles/search_engine" class="" aria-label="(译) 查询引擎"><!--[--><!--]--> (译) 查询引擎 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="学习笔记 📚"><span class="title">学习笔记 📚</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="学习笔记 📚"><span class="title">学习笔记 📚</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>前端相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/frontend/vdom" class="" aria-label="虚拟 DOM"><!--[--><!--]--> 虚拟 DOM <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/js_advanced" class="" aria-label="Js 进阶"><!--[--><!--]--> Js 进阶 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/list" class="" aria-label="资料"><!--[--><!--]--> 资料 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/vue" class="" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/http" class="" aria-label="HTTP 相关"><!--[--><!--]--> HTTP 相关 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/frontend/flutter" class="" aria-label="Flutter"><!--[--><!--]--> Flutter <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Python 相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/other/python" class="" aria-label="总览"><!--[--><!--]--> 总览 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>Java 相关</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/java/java" class="" aria-label="基础知识"><!--[--><!--]--> 基础知识 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/sourceread" class="" aria-label="部分源码"><!--[--><!--]--> 部分源码 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/spring" class="" aria-label="Spring 框架"><!--[--><!--]--> Spring 框架 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/java/springboot" class="" aria-label="常用工具"><!--[--><!--]--> 常用工具 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="小玩具 🎮"><span class="title">小玩具 🎮</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="小玩具 🎮"><span class="title">小玩具 🎮</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/projects/mini_vue" class="" aria-label="Mini-Vue"><!--[--><!--]--> Mini-Vue <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/projects/mini_bundle" class="" aria-label="打包器"><!--[--><!--]--> 打包器 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/projects/mini_tokio" class="" aria-label="异步运行时"><!--[--><!--]--> 异步运行时 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="IO Club ⚽"><span class="title">IO Club ⚽</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="IO Club ⚽"><span class="title">IO Club ⚽</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>分享</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ioclub/share_1" class="" aria-label="关于数据库与 B+ 树"><!--[--><!--]--> 关于数据库与 B+ 树 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><li class="navbar-dropdown-item"><!--[--><h4 class="navbar-dropdown-subtitle"><span>授课</span></h4><ul class="navbar-dropdown-subitem-wrapper"><!--[--><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_1" class="" aria-label="后端 1"><!--[--><!--]--> 后端 1 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_2" class="" aria-label="后端 2"><!--[--><!--]--> 后端 2 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_3" class="" aria-label="后端 3"><!--[--><!--]--> 后端 3 <!--[--><!--]--></a></li><li class="navbar-dropdown-subitem"><a href="/ioclub/backend_4" class="" aria-label="后端 4"><!--[--><!--]--> 后端 4 <!--[--><!--]--></a></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="资料库 📦"><span class="title">资料库 📦</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="资料库 📦"><span class="title">资料库 📦</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a href="/other/hadoop" class="" aria-label="大数据"><!--[--><!--]--> 大数据 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/script" class="" aria-label="脚本"><!--[--><!--]--> 脚本 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/datastructure" class="" aria-label="数据结构"><!--[--><!--]--> 数据结构 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/vim" class="" aria-label="Vim"><!--[--><!--]--> Vim <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/git" class="" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/docker" class="" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/analyze" class="" aria-label="性能监测工具"><!--[--><!--]--> 性能监测工具 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/oci" class="" aria-label="OCI 规范"><!--[--><!--]--> OCI 规范 <!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a href="/other/oauth2" class="" aria-label="OAuth2.0"><!--[--><!--]--> OAuth2.0 <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a class="external-link" href="https://github.com/trdthg" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">分布式系统 <!----></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/draft/DistributedSystem.html#优势" class="router-link-active router-link-exact-active sidebar-item" aria-label="优势"><!--[--><!--]--> 优势 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/draft/DistributedSystem.html#挑战" class="router-link-active router-link-exact-active sidebar-item" aria-label="挑战"><!--[--><!--]--> 挑战 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/draft/DistributedSystem.html#主题" class="router-link-active router-link-exact-active sidebar-item" aria-label="主题"><!--[--><!--]--> 主题 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/draft/DistributedSystem.html#lab" class="router-link-active router-link-exact-active sidebar-item" aria-label="Lab"><!--[--><!--]--> Lab <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/draft/DistributedSystem.html#map-reduce" class="router-link-active router-link-exact-active sidebar-item" aria-label="Map-Reduce"><!--[--><!--]--> Map-Reduce <!--[--><!--]--></a><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/draft/DistributedSystem.html#概述" class="router-link-active router-link-exact-active sidebar-item" aria-label="概述"><!--[--><!--]--> 概述 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/draft/DistributedSystem.html#mapreduce-系统的优缺点" class="router-link-active router-link-exact-active sidebar-item" aria-label="MapReduce 系统的优缺点"><!--[--><!--]--> MapReduce 系统的优缺点 <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/draft/DistributedSystem.html#mr-的工作细节。" class="router-link-active router-link-exact-active sidebar-item" aria-label="MR 的工作细节。"><!--[--><!--]--> MR 的工作细节。 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="分布式系统" tabindex="-1"><a class="header-anchor" href="#分布式系统" aria-hidden="true">#</a> 分布式系统</h1><h2 id="优势" tabindex="-1"><a class="header-anchor" href="#优势" aria-hidden="true">#</a> 优势</h2><ul><li><p>通过并行计算增加容量 (parallelism)</p></li><li><p>通过复制容忍故障 (fault tolerance)</p></li><li><p>匹配物理设备的分布 (physical)</p></li><li><p>通过隔离来实现安全 (security / isolated)</p><ul><li>将安全的和不安全的计算放在不同机器上运行</li><li>系统间通过网络进行交互</li></ul></li></ul><h2 id="挑战" tabindex="-1"><a class="header-anchor" href="#挑战" aria-hidden="true">#</a> 挑战</h2><ul><li><p>分布式系统有许多部分组成，这些部分是同时运行的，会遇到各种并发编程和复杂交互带来的问题。因此需要某些机制在时间上进行控制（比如超时机制，熔断机制）。</p></li><li><p>多台计算机加网络会使故障原因也更加复杂</p></li><li><p>性能，n 台计算机并不能达到 n 倍的性能</p></li></ul><h2 id="主题" tabindex="-1"><a class="header-anchor" href="#主题" aria-hidden="true">#</a> 主题</h2><ol><li><p>一致性</p><p>通用的基础设施需要有明确的行为。例如，&quot;Get(k) 获取最近一次 Put(k,v) 的值&quot;。</p><p>实现良好的行为是很难的！ &quot;复制&quot; 的服务器很难保持一致。</p></li><li><p>性能</p><p>目标：可扩展的吞吐量</p><p>Nx 个服务器，通过并行的 CPU、磁盘、网络实现 Nx 个总吞吐量。随着 N 的增长，扩展会变得更加困难，负载不平衡。有些事情不会随着 N 的增加而加快，例如初始化、交互。</p></li><li><p>权衡</p><p>容错性、一致性和性能是敌人。实现容错性和一致性需要通信</p><ul><li><p>发送数据到备份</p></li><li><p>检查数据是否是最新的。</p></li><li><p>通信通常很慢，而且不可扩展</p></li><li><p>许多设计只提供弱的一致性，以获得速度。</p><ul><li>例如，Get() 并不*产生最新的 Put()! 对于应用程序的程序员来说，这是很痛苦的，但可能是一个很好的权衡。</li></ul></li></ul><p>我们会在一致性/性能中看到许多设计点。</p></li><li><p>实现</p><p>RPC、线程、并发控制。</p></li></ol><h2 id="lab" tabindex="-1"><a class="header-anchor" href="#lab" aria-hidden="true">#</a> Lab</h2><ul><li><p>Map-Reduce</p></li><li><p>Raft 解决容错性</p></li><li><p>使用 Raft 构建 K/V server，它可以被复制</p></li><li><p>Sharded K/V server 将有可复制能力的主备 K/V server 克隆到多个组中，并将之前的数据分割存储到这些组中，提高运行速度（每个组只存储自己对应的数据，组合起来就是一整份数据）。同时还要实现在不同的服务期间移动数据，保证不会丢失（数据分片到各个组中，各组的服务器内也会有主从复制）。</p></li></ul><h2 id="map-reduce" tabindex="-1"><a class="header-anchor" href="#map-reduce" aria-hidden="true">#</a> Map-Reduce</h2><p>以一个 word-count 为例，如果集群要对上万的文件进行计算，GFS 会先寻找到文件的所在位置，然后直接在本机的 map-reduce 程序中运行，从而节约了大量的网络传输。</p><blockquote><p>将按行存储转换为按列存储的过程，在论文中成为 shuffle</p></blockquote><h3 id="概述" tabindex="-1"><a class="header-anchor" href="#概述" aria-hidden="true">#</a> 概述</h3><p>背景：在多 TB 级数据集上进行多小时的计算，例如，建立搜索索引，或排序，或分析网络的结构，只有在有 1000 台计算机的情况下才实用。</p><p>但是应用不是由分布式系统专家编写的，它的总体目标是让非专业的程序员也能轻松使用，对于程序员来说，他只需要定义 Map 和 Reduce 函数 (通常是相当简单的同步代码). MR 管理并隐藏了分布式的所有细节！</p><p>一个 MapReduce 作业的抽象视图</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>输入 1 -&gt; Map -&gt; a,1 b,1
输入 2 -&gt; Map -&gt; b,1
输入 3 -&gt; Map -&gt; a,1 c,1
| | |
| | -&gt; Reduce -&gt; c,1
| -----&gt; Reduce -&gt; b,2
---------&gt; Reduce -&gt; a,2
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><ol><li>输入文件（已经）被分成 M 个文件</li></ol></li><li><ol start="2"><li>MR 对每个输入文件调用 Map()，产生一组 k2, v2 的 &quot;中间&quot; 数据，每个 Map() 调用都是一个 &quot;任务&quot;</li></ol></li><li><ol start="3"><li>当地图被 Reduce 时。MR 会收集给定 k2 的所有中间 v2。并将每个键和值传递给一个 Reduce 调用</li></ol></li><li><ol start="4"><li>最终输出是来自 Reduce() 的&lt;k2,v3&gt;对的集合。</li></ol></li></ul><p>以 wordcount 为例：</p><ul><li>Map(k, v) 将 v 分割成单词</li><li>对于每个词 w, emit(w, &quot;1&quot;)</li><li>Reduce(k, v_set)</li><li>emit(len(v_set))</li></ul><h3 id="mapreduce-系统的优缺点" tabindex="-1"><a class="header-anchor" href="#mapreduce-系统的优缺点" aria-hidden="true">#</a> MapReduce 系统的优缺点</h3><ol><li><p>MapReduce 的扩展性很好。</p><p>N 个 worker 计算机（可能）让你获得 Nx 的吞吐量。Maps() 和 Reduce() 可以并行运行，因为它们不相互影响。因此，更多的计算机可以带来更多的吞吐量！</p></li><li><p>MapReduce 隐藏了很多细节。</p><ul><li>发送应用代码到服务器</li><li>跟踪哪些任务已经完成</li><li>将中间数据从 Maps &quot;洗&quot; 到 Reduce 中去</li><li>平衡服务器上的负载</li><li>从故障中恢复。</li></ul></li><li><p>MapReduce 限制了应用程序可以做的事。</p><ul><li>没有互动或状态 (除了通过中间输出)</li><li>没有迭代</li><li>没有实时或流式处理</li></ul></li><li><p>MapReduce 输入和输出都存储在 GFS 集群文件系统上</p><ul><li>MR 需要巨大的并行输入和输出的吞吐量。</li><li>GFS 将文件分割到许多服务器上，以 64MB 为一个块。 <ul><li>Map 并行读取</li><li>Reduce 并行写入</li></ul></li><li>GFS 还将每个文件复制到 2 或 3 个服务器上</li></ul></li></ol><h3 id="mr-的工作细节。" tabindex="-1"><a class="header-anchor" href="#mr-的工作细节。" aria-hidden="true">#</a> MR 的工作细节。</h3><ol><li><p>MapReduce 需要一个协调器，将任务分配给 worker 并纪录进度。</p><p>协调器将 Map 任务分配给 worker，直到所有的 Map 完成。</p><ul><li>Map 将输出（或者说中间数据）写到本地磁盘上</li><li>Map 通过哈希将输出分割到每个 Reduce 任务的一个文件中。</li></ul><p>在所有 Map 完成后，协调器将 Reduce 任务分配给 worker</p><ul><li>每个 Reduce 任务从（所有）Map worker 那里获取其中间输出。</li><li>每个 Reduce 任务在 GFS 上写入一个单独的输出文件</li></ul></li><li><p>什么可能会限制性能？</p><p>CPU、内存、磁盘、网络？在 2004 年，论文作者受到了网络容量的限制。</p><p>MR 在网络上发送什么？</p><ul><li>Map 从 GFS 读取输入。</li><li>Reduces 读取 Map 的中间输出。通常和输入一样大，例如用于排序。</li><li>Reduces 写输出文件到 GFS。</li></ul><p>在 MR 的 shuffle 过程中，一半的流量要经过根交换机。</p><p>论文的根交换机速度为 100 ~ 200 Gb/s，总共有 1800 台机器，所以每台机器可以分得 55 Gb/s。相比于磁盘或 RAM 的速度小得多。</p></li><li><p>MR 如何尽量减少网络的使用？</p><ul><li><p>协调器试图在存储其输入的 GFS 服务器上原地运行每个 Map 任务。所有的计算机都会同时运行 GFS 和 MR worker, 所以 Map 的输入都会通过 GFS 在本地磁盘读取，而不是网络。</p></li><li><p>中间数据被分割为许多文件，每个文件都存储了许多 key. 文件数量比 key 要少得多，大文件传输的效率要更高</p></li></ul></li><li><p>MR 如何处理负载均衡？</p><p>如果 N-1 个服务器必须等待 1 个慢速服务器完成，则是浪费和缓慢的。但有些任务可能确实比其他任务花的时间更长。</p><p>解决方法：比 worker 数量多得多的任务</p><ul><li>协调器将新的任务分配给完成先前任务的 worker。</li><li>因此，没有一个任务大到可以支配完成时间（希望如此）。</li><li>因此，快的服务器会比慢的服务器做更多的任务，完成的时间也差不多。</li></ul></li><li><p>MR 的容错性如何？</p><p>如果一个 worker 在 MP 任务中崩溃了怎么办？ MR 会对程序员隐藏故障。</p><p>MR 不必从头开始重新运行整个工作，它只重新运行失败的 Map 和 Reduce。假设 MR 将一个 Map 运行了两次，一个 Reduce 看到了第一次运行的输出。另一个 Reduce 看到了第二次运行的输出？</p><p>正确性要求重新执行时产生完全相同的输出。所以 Map 和 Reduce 必须是纯确定性的函数。它们只允许看它们的参数/输入。没有状态，没有文件 I/O，没有交互，没有外部通信。</p><p>如果你想允许 non-functional 的 Map 或 Reduce 呢？worker 失败将重新执行整个工作。或者是回滚到某个全局检查点。</p></li><li><p>崩溃恢复的细节</p><ul><li><p>一个 Map worker 崩溃了。</p><ul><li>协调器注意到 worker 不再响应 ping</li><li>协调器知道哪些 Map 任务在该 worker 上运行 <ul><li>这些任务的中间输出现在已经丢失，必须重新运行</li><li>协调器通知其他 worker 运行这些任务</li></ul></li><li>如果所有的 Reduce 任务都获取了中间数据，可以不重新运行。</li></ul></li><li><p>一个 Reduce worker 崩溃了。</p><ul><li>完成的任务是好的 -- 已经存储在 GFS 中，并且保存有副本。</li><li>协调器在其他 worker 上重新启动未完成的任务。</li></ul></li></ul></li><li><p>其他故障/问题。</p><ul><li><p>如果协调者给两个 worker 分配了相同的 Map 任务怎么办？</p><p>= 也许协调器错误地认为一个 worker 死了。它将只告诉 Reduce worer 其中一个。</p></li><li><p>如果协调者给了两个 worker 同样的 Reduce() 任务怎么办？</p><ul><li>他们都会试图在 GFS 上写下同一个输出文件！</li><li>GFS 的原子重命名可以防止混合；一个完整的文件将是可见的。</li></ul></li><li><p>如果一个 worker 非常慢 --&quot;散兵游勇&quot;，怎么办？</p><ul><li>也许是硬件它弱。</li><li>协调器启动最后几个任务的第二个副本。</li></ul></li><li><p>如果一个 worker 由于硬件或软件损坏而计算出不正确的输出，怎么办？</p><ul><li>太糟糕了！MR 假设 &quot;故障停止&quot; 的 CPU 和软件。</li></ul></li><li><p>如果协调器崩溃了怎么办？</p></li></ul></li><li><p>目前的状况？</p><ul><li>影响力巨大（Hadoop, Spark, &amp;c）。</li><li>可能谷歌已经不使用了。 <ul><li>被Flume/FlumeJava取代（见Chambers等人的论文）。</li><li>GFS 被 Colossus（没有好的描述）和 BigTable 取代。</li></ul></li></ul></li><li><p>结论</p><p>MapReduce 使大集群计算流行起来。</p><ul><li>不是最有效或最灵活的。</li></ul><ul><li>扩展性好。</li><li>易于编程 -- 失败和数据移动被隐藏。</li></ul><p>这些在实践中是很好的权衡。现在已经有了一些更高级的继承者。</p></li></ol><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="external-link meta-item-label" href="https://github.com/trdthg/edit/main/draft/DistributedSystem.md" rel="noopener noreferrer" target="_blank" aria-label="Edit this page"><!--[--><!--]--> Edit this page <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></div><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/assets/app.87562571.js" defer></script>
  </body>
</html>
